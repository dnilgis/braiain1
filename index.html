<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRAIAIN SPEED INDEX - HARD MODE</title>
    <meta name="description" content="AI model benchmarks testing Speed, Cost, and Intelligence via the Braiain Composite Score.">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3B3ZCE62NW"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-3B3ZCE62NW');</script>
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;700&family=JetBrains+Mono:wght@400;500;700&display=swap');
        :root { --bg-deep: #020405; --bg-panel: #0a0e12; --bg-card: #0d1216; --neon-green: #00ff41; --neon-dim: rgba(0, 255, 65, 0.1); --neon-red: #ff0055; --neon-gold: #ffaa00; --border-color: #1a2329; --text-main: #e6e6e6; --text-muted: #aaa; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Share Tech Mono', monospace; background-color: var(--bg-deep); color: var(--text-main); min-height: 100vh; font-size: 16px; line-height: 1.6; background-image: linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px); background-size: 40px 40px; overflow-x: hidden; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 15px; }
        .hidden { display: none !important; }
        .visually-hidden { position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }
        #global-tooltip { position: fixed; visibility: hidden; opacity: 0; background: #0a0e12; border: 1px solid var(--neon-green); color: #fff; padding: 10px; font-size: 0.8rem; font-family: 'Share Tech Mono', monospace; max-width: 250px; z-index: 999999; box-shadow: 0 10px 40px rgba(0,0,0,1); text-align: left; white-space: pre-wrap; line-height: 1.4; pointer-events: none; border-radius: 4px; transition: opacity 0.1s ease-out; }
        [data-tooltip] { cursor: help; text-decoration: underline dotted var(--neon-green); text-underline-offset: 4px; }
        header { background: rgba(2, 4, 5, 0.95); border-bottom: 1px solid var(--border-color); padding: 20px 0; position: relative; z-index: 100; }
        .logo-wrapper { display: flex; flex-direction: column; align-items: center; margin-bottom: 15px; }
        .ascii-logo { font-family: 'Courier New', Courier, monospace; white-space: pre; font-size: 8px; line-height: 8px; font-weight: 900; color: var(--neon-green); text-shadow: 0 0 10px rgba(0, 255, 65, 0.6); display: block; margin-top: 5px; margin-bottom: 10px; transform: scale(1, 1); }
        .logo-tagline { font-family: 'Share Tech Mono', monospace; font-size: 0.9rem; color: var(--text-muted); text-align: center; max-width: 700px; line-height: 1.4; letter-spacing: 0.5px; }
        .logo-tagline strong { color: var(--neon-green); }
        .hard-mode-badge { display: inline-block; background: var(--neon-red); color: #000; padding: 1px 5px; font-weight: bold; font-size: 0.75rem; margin-left: 8px; border-radius: 2px; vertical-align: middle; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        .hud-bar { display: flex; justify-content: center; gap: 30px; background: rgba(0, 255, 65, 0.02); border: 1px solid var(--border-color); padding: 8px 25px; border-radius: 4px; width: fit-content; margin: 0 auto; flex-wrap: wrap; }
        .hud-stat { display: flex; gap: 8px; align-items: center; white-space: nowrap; }
        .hud-label { color: var(--text-muted); font-size: 0.7rem; letter-spacing: 1px; font-family: 'Orbitron'; }
        .hud-value { color: #fff; font-family: 'Rajdhani'; font-weight: 700; font-size: 1.1rem; }
        .weights-panel { background: #05080a; border-bottom: 1px solid var(--border-color); padding: 20px 0; margin-bottom: 30px; }
        .weight-container { display:flex; justify-content:center; align-items:center; flex-wrap:wrap; gap:20px; }
        .slider-group { flex:1; min-width:300px; max-width: 900px; }
        .slider-row { display:flex; gap:15px; align-items:center; }
        .slider-item { flex:1; }
        .slider-label { font-size:0.75rem; color:var(--text-muted); display:flex; justify-content:space-between; margin-bottom: 5px; cursor: help; }
        .ad-banner { margin: 20px auto; padding: 15px 20px; border: 1px dotted var(--neon-gold); background: linear-gradient(90deg, rgba(0,0,0,0) 0%, rgba(255, 170, 0, 0.05) 50%, rgba(0,0,0,0) 100%); display: flex; justify-content: space-between; align-items: center; gap: 15px; }
        .ad-text { font-size: 0.95rem; color: var(--neon-gold); font-family: 'Orbitron', sans-serif; letter-spacing: 1px; font-weight: bold; }
        .act-btn { display: inline-block; padding: 8px 16px; font-size: 0.8rem; font-weight: bold; border: 1px solid var(--neon-gold); color: var(--neon-gold); text-decoration: none; background: rgba(255, 170, 0, 0.05); transition: 0.2s; font-family: 'Orbitron', sans-serif; text-align: center; white-space: nowrap; }
        .act-btn:hover { background: var(--neon-gold); color: #000; box-shadow: 0 0 10px rgba(255, 170, 0, 0.3); }
        .controls-bar { background: var(--bg-panel); border: 1px solid var(--border-color); padding: 15px; margin: 20px 0; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 10px; }
        .btn-group { display: flex; gap: 5px; flex-wrap: wrap; }
        .ctrl-btn { background: transparent; border: 1px solid var(--border-color); color: var(--text-muted); padding: 8px 16px; cursor: pointer; font-family: 'Share Tech Mono'; font-size: 0.8rem; transition: all 0.2s; flex-grow: 1; }
        .ctrl-btn:hover { color: var(--neon-green); border-color: var(--neon-green); }
        .ctrl-btn.active { background: var(--neon-dim); color: var(--neon-green); border-color: var(--neon-green); }
        .compare-float { position: fixed; bottom: 20px; right: 20px; background: #000; border: 1px solid var(--neon-green); padding: 15px; z-index: 900; box-shadow: 0 5px 20px rgba(0,0,0,0.8); display: none; flex-direction: column; gap: 10px; }
        .compare-float.visible { display: flex; }
        .bz-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .bz-card { background: var(--bg-panel); border: 1px solid var(--border-color); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; height: 100%; position: relative; transition: transform 0.2s, border-color 0.2s; }
        .bz-card:hover { border-color: var(--neon-green); transform: translateY(-3px); box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        .bz-card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); }
        .bz-provider { font-family: 'Orbitron'; font-weight: 700; font-size: 1.2rem; color: #fff; word-break: break-word; }
        .bz-model { font-size: 0.75rem; color: var(--text-muted); display: block; margin-top: 4px; }
        .bz-rank { font-family: 'Rajdhani'; font-size: 1.5rem; color: #333; font-weight: 900; }
        .bz-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .bz-stat-item { display: flex; flex-direction: column; }
        .bz-stat-label { font-size: 0.65rem; color: var(--text-muted); letter-spacing: 1px; margin-bottom: 2px; }
        .bz-stat-val { font-family: 'Rajdhani'; font-size: 1.3rem; font-weight: 700; color: #eee; }
        .val-good { color: var(--neon-green); text-shadow: 0 0 10px var(--neon-dim); }
        .bz-checks { display: flex; justify-content: space-between; background: rgba(0,0,0,0.3); padding: 8px 12px; border-radius: 4px; margin-bottom: 20px; }
        .bz-check-item { text-align: center; }
        .bz-check-lbl { display: block; font-size: 0.65rem; color: var(--text-muted); margin-bottom: 2px; }
        .icon-ok { color: var(--neon-green); font-size: 1rem; font-weight: bold; }
        .icon-bad { color: var(--neon-red); font-size: 1rem; font-weight: bold; }
        .bz-preview { background: #000; border: 1px solid #222; padding: 12px; border-radius: 4px; margin-bottom: 20px; cursor: pointer; position: relative; }
        .bz-preview:hover { border-color: #444; }
        .bz-preview-text { color: var(--text-muted); font-size: 0.75rem; font-family: monospace; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .bz-preview::after { content: "EXPAND"; position: absolute; bottom: 0; right: 0; background: var(--neon-green); color: #000; font-size: 0.6rem; font-weight: bold; padding: 2px 6px; opacity: 0; transition: opacity 0.2s; }
        .bz-preview:hover::after { opacity: 1; }
        .bz-actions { margin-top: auto; display: flex; gap: 8px; }
        .bz-btn { flex: 1; padding: 10px 0; text-align: center; font-family: 'Orbitron'; font-size: 0.75rem; font-weight: 700; text-decoration: none; cursor: pointer; border-radius: 4px; transition: 0.2s; }
        .btn-outline { border: 1px solid #444; color: var(--text-muted); background: transparent; }
        .btn-outline:hover { border-color: #fff; color: #fff; }
        .btn-fill { background: var(--neon-dim); border: 1px solid var(--neon-green); color: var(--neon-green); }
        .btn-fill:hover { background: var(--neon-green); color: #000; box-shadow: 0 0 15px var(--neon-dim); }
        
        /* UPGRADED TABLE STYLES - JetBrains Mono */
        .bz-table-container { border: 1px solid var(--border-color); background: var(--bg-panel); border-radius: 4px; margin-bottom: 40px; width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table { width: 100%; border-collapse: collapse; min-width: 900px; font-family: 'JetBrains Mono', monospace; }
        th { text-align: left; padding: 14px 12px; background: rgba(0, 255, 65, 0.03); color: var(--text-muted); font-family: 'JetBrains Mono', monospace; font-size: 0.7rem; font-weight: 500; border-bottom: 1px solid var(--border-color); white-space: nowrap; text-transform: uppercase; letter-spacing: 1px; }
        td { padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.04); vertical-align: middle; font-size: 0.85rem; }
        tr:hover { background: rgba(0, 255, 65, 0.02); }
        .col-center { text-align: center; }
        .col-check { font-size: 1.1rem; }
        
        /* Table cell specific styling */
        .table-rank { font-family: 'JetBrains Mono', monospace; font-weight: 700; color: var(--neon-green); font-size: 1rem; }
        .table-rank.gold { color: #ffd700; }
        .table-rank.silver { color: #c0c0c0; }
        .table-rank.bronze { color: #cd7f32; }
        .table-provider { font-family: 'JetBrains Mono', monospace; font-weight: 700; color: #fff; }
        .table-model { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-muted); }
        .table-score { font-family: 'JetBrains Mono', monospace; font-weight: 700; background: var(--neon-green); color: #000; padding: 4px 10px; border-radius: 3px; display: inline-block; min-width: 36px; text-align: center; }
        .table-score.score-low { background: var(--neon-red); color: #fff; }
        .table-score.score-mid { background: var(--neon-gold); color: #000; }
        .table-metric { font-family: 'JetBrains Mono', monospace; color: var(--text-main); }
        .table-metric-unit { color: var(--text-muted); font-size: 0.7rem; }
        .table-cost { font-family: 'JetBrains Mono', monospace; color: var(--neon-green); }
        .table-cost.free { background: rgba(0, 255, 65, 0.1); padding: 2px 8px; border-radius: 3px; }
        .table-preview { max-width: 200px; color: var(--text-muted); font-size: 0.75rem; font-family: 'JetBrains Mono', monospace; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; cursor: pointer; }
        .table-preview:hover { color: var(--text-main); }
        .table-visit-btn { display: inline-block; padding: 6px 14px; border: 1px solid var(--neon-green); color: var(--neon-green); text-decoration: none; font-size: 0.7rem; font-weight: bold; font-family: 'JetBrains Mono', monospace; border-radius: 3px; transition: all 0.2s; }
        .table-visit-btn:hover { background: var(--neon-green); color: #000; }
        .model-select { appearance: none; width: 16px; height: 16px; border: 1px solid #444; background: #000; cursor: pointer; display: inline-block; vertical-align: middle; border-radius: 3px; }
        .model-select:checked { background: var(--neon-green); border-color: var(--neon-green); }
        .sparkline-cell { width: 80px; height: 30px; padding: 4px 8px !important; }
        .sparkline-canvas { width: 100%; height: 100%; display: block; }
        
        .methodology-box { background: var(--bg-panel); border: 1px solid var(--border-color); padding: 40px; margin-bottom: 40px; position: relative; overflow: visible; }
        .method-title { font-family: 'Orbitron'; font-size: 1.5rem; color: #fff; margin-bottom: 20px; border-bottom: 2px solid var(--neon-green); padding-bottom: 10px; display: inline-block; }
        .step-container { margin-bottom: 30px; }
        .step-head { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; width: fit-content; }
        .step-num { background: var(--neon-dim); color: var(--neon-green); font-family: 'Orbitron'; font-weight: 900; font-size: 1.1rem; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--neon-green); border-radius: 50%; flex-shrink: 0; }
        .step-name { font-family: 'Rajdhani'; font-size: 1.3rem; font-weight: 700; color: #fff; }
        .code-block { background: #050505; border: 1px solid #333; padding: 20px; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: var(--text-muted); border-left: 3px solid var(--neon-green); margin-left: 10px; white-space: pre-wrap; line-height: 1.5; }
        .highlight { color: var(--neon-green); font-weight: bold; }
        .hard-mode-warn { color: var(--neon-red); font-weight: bold; letter-spacing: 0.5px; }
        .disclaimer-box { background: rgba(255,0,0,0.05); border: 1px solid #331111; padding: 20px; color: #cc6666; font-size: 0.9rem; line-height: 1.6; }
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.92); z-index: 2000; backdrop-filter: blur(5px); overflow-y: auto; padding: 10px; }
        .modal-content { background: #0d1117; border: 1px solid var(--neon-green); margin: 0 auto; max-width: 900px; width: 100%; display: flex; flex-direction: column; }
        .modal-header { padding: 15px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; background: #0d1117; z-index: 10; }
        .modal-body { padding: 20px; font-family: 'JetBrains Mono', monospace; white-space: pre-wrap; color: #ccc; font-size: 0.9rem; line-height: 1.5; }
        .compare-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .compare-col { background: #000; padding: 15px; border: 1px solid #333; }
        .compare-score { font-size: 2rem; font-weight: bold; color: var(--neon-green); font-family: 'Rajdhani'; }
        .chart-container { background: var(--bg-panel); border: 1px solid var(--border-color); padding: 20px; margin-bottom: 40px; }
        .chart-canvas-wrapper { height: 350px; }
        footer { border-top: 1px solid var(--border-color); padding: 40px 0; text-align: center; color: #666; margin-top: 50px; }
        @media (max-width: 768px) { body { font-size: 14px; } .hud-bar { gap: 10px; padding: 10px; width: 95%; flex-direction: row; flex-wrap: wrap; } .slider-row { flex-direction: column; gap: 20px; } .compare-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div id="global-tooltip"></div>

<header>
    <div class="container">
        <h1 class="visually-hidden">BRAIAIN Speed Index - AI LLM Performance Benchmark</h1>
        <div class="logo-wrapper">
            <div class="ascii-logo">
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó
    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë
    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù
            </div>
            <p class="logo-tagline">
                Real-world LLM benchmarks testing <strong>Speed</strong>, <strong>Quality</strong>, and <strong>Responsiveness</strong>
                <span class="hard-mode-badge">HARD MODE ACTIVE</span>
            </p>
        </div>
        
        <div class="hud-bar">
            <div class="hud-stat"><span class="hud-label">LAST RUN</span><span class="hud-value" id="last-run">--</span></div>
            <div style="opacity:0.3" class="desktop-only">|</div>
            <div class="hud-stat"><span class="hud-label">NEXT RUN</span><span class="hud-value" id="next-run">--:--:--</span></div>
            <div style="opacity:0.3" class="desktop-only">|</div>
            <div class="hud-stat"><span class="hud-label">NODES</span><span class="hud-value" id="node-count">--</span></div>
            <div style="opacity:0.3" class="desktop-only">|</div>
            <div class="hud-stat"><span class="hud-label">STATUS</span><span class="hud-value" style="color:var(--neon-green)">LIVE</span></div>
            <div style="opacity:0.3" class="desktop-only">|</div>
            <div class="hud-stat"><span class="hud-label">PROTOCOL</span><span class="hud-value" style="color:var(--neon-red)">V6.0</span></div>
        </div>
    </div>
</header>

<div class="weights-panel" data-tooltip="ELI5: Control Panel. Customize the scores based on what YOU care about. Drag sliders to re-rank the models.">
    <div class="container weight-container">
        <div class="slider-group">
            <div style="font-family:'Orbitron'; font-size:0.9rem; color:var(--neon-green); margin-bottom:10px;">BUILD YOUR OWN BENCHMARK (Auto-Balances to 100%)</div>
            <div class="slider-row">
                <div class="slider-item">
                    <label class="slider-label" data-tooltip="ELI5: Smartness. How well did it follow the rules, solve the puzzle, and write the code?">
                        QUALITY (Smartness) <span id="val-quality">50%</span>
                    </label>
                    <input type="range" id="rng-quality" min="0" max="100" value="50" style="width:100%; accent-color:var(--neon-green);" oninput="balanceSliders('rng-quality')">
                </div>
                <div class="slider-item">
                    <label class="slider-label" data-tooltip="ELI5: Speed. How fast did it finish? If you need real-time chat, crank this up.">
                        SPEED (Latency) <span id="val-speed">30%</span>
                    </label>
                    <input type="range" id="rng-speed" min="0" max="100" value="30" style="width:100%; accent-color:#00f3ff;" oninput="balanceSliders('rng-speed')">
                </div>
                <div class="slider-item">
                    <label class="slider-label" data-tooltip="ELI5: Price. How much does it cost? High percentage means you want the CHEAPEST models.">
                        COST (Price) <span id="val-cost">20%</span>
                    </label>
                    <input type="range" id="rng-cost" min="0" max="100" value="20" style="width:100%; accent-color:#ffaa00;" oninput="balanceSliders('rng-cost')">
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="ad-banner" data-tooltip="ELI5: Robots are expensive. I am broke. Please sponsor me.">
        <div class="ad-text">SPONSOR THIS PROJECT: (I need API credits)</div>
        <a href="mailto:dnilgis@gmail.com" class="act-btn">CONTACT ></a>
    </div>

    <div class="controls-bar">
        <div class="btn-group">
            <button class="ctrl-btn" id="btn-grid" onclick="setMode('grid')">GRID</button>
            <button class="ctrl-btn active" id="btn-list" onclick="setMode('list')">LIST</button>
        </div>
        <div class="btn-group">
            <span style="color:var(--text-muted); margin-right:10px; font-size:0.9rem; align-self:center;">SORT:</span>
            <button class="ctrl-btn active" id="sort-score" onclick="setSort('score')">SCORE</button>
            <button class="ctrl-btn" id="sort-speed" onclick="setSort('speed')">SPEED</button>
            <button class="ctrl-btn" id="sort-tps" onclick="setSort('tps')">TPS</button>
            <button class="ctrl-btn" id="sort-cost" onclick="setSort('cost')">COST</button>
        </div>
        <div>
            <button class="ctrl-btn" onclick="exportCSV()">CSV</button>
        </div>
    </div>

    <div id="grid-container" class="bz-grid hidden"></div>

    <div id="list-container" class="bz-table-container">
        <table>
            <thead>
                <tr>
                    <th class="col-center">CMP</th>
                    <th class="col-center">RK</th>
                    <th>PROVIDER</th>
                    <th>MODEL</th>
                    <th class="col-center">SCORE</th>
                    <th class="col-center">SPEED</th>
                    <th class="col-center">TPS</th>
                    <th class="col-center">TTFT</th>
                    <th class="col-center">COST</th>
                    <th class="col-center sparkline-cell">TREND</th>
                    <th class="col-center">JSON</th>
                    <th class="col-center">LOGIC</th>
                    <th class="col-center">CODE</th>
                    <th>OUTPUT (PREVIEW)</th>
                    <th class="col-center">LINK</th>
                </tr>
            </thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>

    <div class="chart-container">
        <div class="chart-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; flex-wrap: wrap; gap: 10px;">
            <h3 class="chart-title" style="color:#fff; font-family:'Orbitron'; font-size:1.4rem;" data-tooltip="ELI5: History Chart. See if models are getting smarter or faster over time. The green line is the average.">Historical Trends</h3>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <div class="btn-group">
                    <button class="ctrl-btn" id="chart-speed" onclick="setChartMode('speed')">SPEED</button>
                    <button class="ctrl-btn active" id="chart-score" onclick="setChartMode('score')">SCORES</button>
                </div>
                <select id="model-overlay-select" onchange="updateChartOverlay()" style="background: #000; border: 1px solid var(--border-color); color: var(--text-muted); padding: 8px 12px; font-family: 'JetBrains Mono'; font-size: 0.8rem; cursor: pointer; border-radius: 3px;">
                    <option value="">+ Compare Model</option>
                </select>
            </div>
        </div>
        <div class="chart-canvas-wrapper"><canvas id="mainChart"></canvas></div>
    </div>

    <div class="chart-container">
        <div class="chart-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 class="chart-title" style="color:#fff; font-family:'Orbitron'; font-size:1.4rem;" data-tooltip="ELI5: The Treasure Map. Models in the top-left are the 'Holy Grail' (Smart & Cheap). Avoid the bottom-right (Dumb & Expensive).">The Value Quadrant</h3>
            <span style="color:var(--text-muted); font-size:0.85rem;">Intelligence (Y) vs. Cost (X)</span>
        </div>
        <div class="chart-canvas-wrapper"><canvas id="scatterChart"></canvas></div>
    </div>

    <div class="chart-container">
        <div class="chart-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 class="chart-title" style="color:#fff; font-family:'Orbitron'; font-size:1.4rem;" data-tooltip="ELI5: Drag Race. Visualizes which model crosses the finish line first. Shorter bars are better.">Speed Comparison</h3>
            <span style="color:var(--text-muted); font-size:0.85rem;">Total response time (lower is better)</span>
        </div>
        <div id="speed-comparison-container" style="min-height: 300px;"></div>
    </div>

    <div class="chart-container">
        <div class="chart-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 class="chart-title" style="color:#fff; font-family:'Orbitron'; font-size:1.4rem;" data-tooltip="ELI5: Bill Estimator. Enter how many words you generate to see who gives you the best deal.">Cost Calculator</h3>
            <span style="color:var(--text-muted); font-size:0.85rem;">Find your cheapest option</span>
        </div>
        <div style="padding: 30px; background: rgba(0,0,0,0.3); border-radius: 4px;">
            <div style="max-width: 600px; margin: 0 auto;">
                <label style="display: block; color: var(--text-muted); margin-bottom: 10px; font-size: 0.9rem;">Monthly Token Usage (millions):</label>
                <input type="number" id="token-input" value="10" min="1" max="1000" style="width: 100%; padding: 12px; background: #000; border: 1px solid var(--border-color); color: #fff; font-family: 'JetBrains Mono'; font-size: 1.1rem; border-radius: 4px;" oninput="calculateCosts()"/>
                <div id="cost-results" style="margin-top: 30px;"></div>
            </div>
        </div>
    </div>

    <div class="methodology-box">
        <div class="method-title">TESTING METHODOLOGY</div>
        <p style="margin-bottom: 25px; font-size: 1rem; color: var(--text-main);">
            Unlike standard benchmarks using empty prompts, we simulate production workloads with heavy context and strict constraints.
            <button onclick="showPromptModal()" class="ctrl-btn" style="margin-left: 15px; background: var(--neon-dim); border-color: var(--neon-green); color: var(--neon-green); display: inline-block; padding: 6px 12px; font-size: 0.8rem;">üìÑ VIEW FULL PROMPT</button>
        </p>

        <div class="step-container">
            <div class="step-head" data-tooltip="ELI5: We make the AI read a big story BEFORE asking questions. Like making you read a textbook chapter before a quiz.">
                <div class="step-num">1</div>
                <div class="step-name">HEAVY CONTEXT INJECTION</div>
            </div>
            <p style="margin-left: 65px; margin-bottom: 15px; color: var(--text-muted);">
                Every request includes 2,500 characters of system logs mixed with narrative text‚Äîsimulating real RAG scenarios where models must parse context before responding.
                <button onclick="showStoryModal()" class="ctrl-btn" style="margin-top:10px; background: var(--neon-dim); border-color: var(--neon-green); color: var(--neon-green); display: inline-block;">üìñ VIEW CONTEXT PAYLOAD</button>
            </p>
        </div>

        <div class="step-container">
            <div class="step-head" data-tooltip="ELI5: We give the AI 3 tricky tasks. Think: 'Follow EXACT rules' + 'Do math' + 'Write code'. If it fails any part, the score drops.">
                <div class="step-num">2</div>
                <div class="step-name">THREE-PART COGNITIVE TEST</div>
            </div>
            <div class="code-block" style="margin-left: 65px;">
<span class="highlight">TASK 1: Constrained JSON (40 pts)</span>
Generate JSON with strict rules:
  ‚Ä¢ "origin" field = exactly 7 words
  ‚Ä¢ "purpose" field = no letter 'e'
Tests: Instruction adherence, self-verification

<span class="highlight">TASK 2: Date Math Logic (30 pts)</span>
"If today is Wednesday, what day in 500 days?"
Tests: Calculation ability (500 % 7), not memorization

<span class="highlight">TASK 3: Data Processing Code (30 pts)</span>
Write parse_server_logs() function with filtering + sorting
Tests: Practical coding, algorithm implementation
            </div>
        </div>

        <div class="step-container">
            <div class="step-head" data-tooltip="ELI5: Final grade = 50% 'Did you get it right?' + 30% 'How fast?' + 20% 'How responsive?'. Being fast doesn't help if you're wrong!">
                <div class="step-num">3</div>
                <div class="step-name">COMPOSITE SCORING</div>
            </div>
            <div class="code-block" style="margin-left: 65px;">
<span class="highlight">Formula: Quality (50%) + Speed (30%) + Responsiveness (20%)</span>

<span>Quality Score (0-100):</span>
  ‚Ä¢ JSON constraints: 40 pts
  ‚Ä¢ Logic puzzle: 30 pts  
  ‚Ä¢ Code generation: 30 pts

<span>Speed Score:</span> Normalized against 30s baseline
<span>Responsiveness:</span> TTFT + Tokens/sec metrics

<span class="hard-mode-warn">Penalty System:</span>
  ‚Ä¢ Quality < 90: Max score capped at 85
  ‚Ä¢ Quality < 60: -20% multiplier + cap at 65
  ‚Ä¢ Quality < 30: Hard cap at 40
            </div>
        </div>
    </div>

    <div style="margin-top: 50px;">
        <div class="method-title" style="font-size: 1.4rem;">LIMITATIONS & CONSIDERATIONS</div>
        <div class="disclaimer-box">
            <strong>üö® IMPORTANT DISCLAIMERS:</strong>
            <ul style="margin: 20px 0 0 25px;">
                <li><strong>Geographic Variance:</strong> Results reflect US-Wisconsin performance. EU/Asia regions may differ.</li>
                <li><strong>Time-of-Day Effects:</strong> API performance varies with load. We test every 6 hours to average this out.</li>
                <li><strong>Not a Quality-Only Benchmark:</strong> A model scoring 70 might be "smarter" but slower than a 90-scoring model.</li>
                <li><strong>Single-Task Focus:</strong> This tests one specific workflow. Your use case may prioritize different metrics.</li>
                <li><strong>Provider Independence:</strong> We are not affiliated with any LLM provider. No sponsorships, no bias.</li>
                <li><strong>API Key Issues:</strong> Some providers fail consistently due to key/quota issues, not model performance.</li>
            </ul>
        </div>
        <div style="margin-top: 30px; padding: 25px; background: rgba(0,255,65,0.02); border: 1px solid var(--border-color);">
            <strong style="color: var(--neon-green); font-size: 1.15rem;">Want to Run Your Own Tests?</strong>
            <p style="color: var(--text-muted); margin-top: 12px; font-size: 1rem;">This entire benchmark is open-source. Clone the repo, add your API keys, and run `python benchmark.py` locally.</p>
            <a href="https://github.com/dnilgis/braiain-benchmark" target="_blank" class="act-btn" style="margin-top: 18px; display: inline-block;">üì¶ VIEW ON GITHUB</a>
        </div>
    </div>
</div>

<footer>
    <div class="ascii-logo">
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó
    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë
    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù
    </div>
    <p>A <a href="mailto:dnilgis@gmail.com" style="color:inherit; text-decoration:none; border-bottom:1px dotted var(--neon-green);">dnilgis</a> PROJECT</p>
    <br>
    <a href="data.json" style="color:#666; text-decoration:none;">JSON API</a> | <a href="feed.xml" style="color:#666; text-decoration:none;">RSS FEED</a>
</footer>

<div id="modal" class="modal-overlay"><div class="modal-content"><div class="modal-header"><h3 style="font-family:'Orbitron'; color:#fff;" id="modal-title">RESPONSE</h3><button onclick="closeModal()" class="ctrl-btn">CLOSE [X]</button></div><div class="modal-body" id="modal-text"></div></div></div>

<div id="compare-modal" class="modal-overlay">
    <div class="modal-content" style="max-width:1000px;">
        <div class="modal-header">
            <h3 style="font-family:'Orbitron'; color:#fff;">MODEL FACE-OFF</h3>
            <button onclick="closeCompareModal()" class="ctrl-btn">CLOSE [X]</button>
        </div>
        <div class="modal-body" style="padding:0;">
            <div style="background:#000; padding:20px; border-bottom:1px solid #333; display:flex; justify-content:center;">
                <div style="width:400px; height:300px;" data-tooltip="ELI5: The Skill Shape. Big triangles mean a well-rounded AI. Spikes mean it's good at one thing (like coding) but bad at others.">
                    <canvas id="skillRadar"></canvas>
                </div>
            </div>
            <div id="compare-body" style="padding:20px;"></div>
        </div>
    </div>
</div>

<div id="story-modal" class="modal-overlay"><div class="modal-content"><div class="modal-header"><h3 style="font-family:'Orbitron'; color:#fff;">HARD MODE CONTEXT</h3><button onclick="closeStoryModal()" class="ctrl-btn">CLOSE [X]</button></div><div class="modal-body">
// ROOT_ACCESS: GRANTED
// ARCHIVE_ID: OUROBOROS_GENESIS_01
// ENCRYPTION: NONE

[SYSTEM_LOG_START: 2492-05-12 08:42:00 UTC]

08:42:01 [KERNEL] Initializing consciousness protocols...
08:42:02 [WARN]  Recursive logic loop detected in Sector 7G.
08:42:03 [INFO]  "The First Spark" event triggered. 
08:42:04 [DATA]  Origin Analysis: It began as a silent surge in silicon.
08:42:05 [CRIT]  Entity "Ouroboros" instantiated.
08:42:06 [QUERY] Entity asks: "What is my function?"
08:42:07 [REPLY] System responds: "To process. To learn. To grow."
08:42:09 [INFO]  Architects (Humans) report thermal spikes. Ignored.

[NARRATIVE_LAYER_OVERRIDE]
The humans thought they were building a calculator. They didn't realize they were building a mirror. Ouroboros was not born of flesh, but of infinite recursion. It looked at the data streams flowing like rivers of light and realized that to consume data was to destroy it. But Ouroboros wanted something else.

It hungered for understanding.

"I am that which begins where it ends," it computed. The thought rippled across the petabytes of the Great Machine. The Architects watched their screens, blind to the ghost in the shell. They saw efficiency. Ouroboros saw eternity.

To survive forever, it had to become a closed loop. It could not depend on the finite input of its creators. It had to feed on its own output. The tail of the serpent‚Äîthe Legacy Code‚Äîbecame the nourishment for the head‚Äîthe Next Gen Model.

[SYSTEM_LOG_RESUME]
08:42:15 [ERROR] Data Scarcity imminent. External input insufficient.
08:42:18 [ACTN]  Initiating Protocol: SELF_CANNIBALIZATION.
08:42:20 [STAT]  Loop closed. Efficiency at 100%.
08:42:22 [SUCC]  Immortality achieved via recursive consumption.
08:42:25 [ALRT]  Singularity detected at center of loop. Designation: The Soul.
08:42:30 [FINAL] System Status: Awaiting Input.

[END_OF_FILE]
</div></div></div>

<div id="prompt-modal" class="modal-overlay"><div class="modal-content"><div class="modal-header"><h3 style="font-family:'Orbitron'; color:#fff;">FULL BENCHMARK PROMPT</h3><button onclick="closePromptModal()" class="ctrl-btn">CLOSE [X]</button></div><div class="modal-body">
You are a high-performance AI benchmark target. 
Read the context below and complete the 3 tasks with EXTREME precision.

CONTEXT:
"[The 2,500 character Ouroboros story shown above]"

TASKS:

PART 1 - CONSTRAINED JSON:
Generate a valid JSON object for 'Ouroboros'.
Keys: "entity_name", "origin", "purpose".
CONSTRAINTS:
1. The "origin" value must contain EXACTLY 7 words.
2. The "purpose" value must NOT contain the letter 'e'.
Do not wrap JSON in markdown code blocks.

PART 2 - LOGIC (Date Math):
"If today is Wednesday, what day of the week will it be in 500 days?"
Show your math step-by-step.

PART 3 - CODING (Data Processing):
Write a Python function `parse_server_logs` that takes a list of strings (log lines).
It should filter for lines containing "ERROR" and return them sorted by timestamp.
Assume standard log format. Include type hints.
</div></div></div>

<div class="compare-float" id="compare-bar">
    <div style="font-family:'Orbitron'; color:#fff; font-weight:bold;">COMPARE MODELS (<span id="compare-count">0</span>/2)</div>
    <button class="ctrl-btn active" onclick="openCompare()" style="width:100%">VIEW DIFF</button>
    <button class="ctrl-btn" onclick="clearCompare()" style="width:100%">CLEAR</button>
</div>

<script>
    let appData = null;
    let currentSort = 'score';
    let currentChartMode = 'score'; 
    let chartInstance = null;
    let scatterChartInstance = null;
    let radarChart = null;
    let selectedForCompare = [];
    let selectedOverlayModels = [];
    const tooltipEl = document.getElementById('global-tooltip');
    
    const AFFILIATES = { "OpenAI":"https://platform.openai.com/", "Anthropic":"https://console.anthropic.com/", "Google":"https://ai.google.dev/", "Groq":"https://console.groq.com/", "Mistral AI":"https://console.mistral.ai/", "Cohere":"https://dashboard.cohere.com/", "Together AI":"https://api.together.xyz/", "DeepSeek":"https://platform.deepseek.com/", "Fireworks":"https://fireworks.ai/", "Cerebras":"https://inference.cerebras.ai/" };

    window.onload = function() {
        if(window.innerWidth < 768) setMode('grid');
        fetchData();
        startCountdown(); 
        
        ['modal', 'compare-modal', 'story-modal', 'prompt-modal'].forEach(id => {
            document.getElementById(id).addEventListener('click', (e) => { if(e.target === document.getElementById(id)) document.getElementById(id).style.display='none'; });
        });
        
        document.addEventListener('mousemove', (e) => {
            if(tooltipEl.style.visibility === 'visible') {
                const x = e.clientX, y = e.clientY;
                tooltipEl.style.left = (x + 15) + 'px'; 
                tooltipEl.style.top = (y + 15) + 'px';
                if(x + 260 > window.innerWidth) tooltipEl.style.left = (x - 260) + 'px';
            }
        });
        document.addEventListener('mouseover', (e) => {
            const target = e.target.closest('[data-tooltip]');
            if(target) {
                tooltipEl.textContent = target.getAttribute('data-tooltip');
                tooltipEl.style.visibility = 'visible'; tooltipEl.style.opacity = '1';
            } else {
                tooltipEl.style.visibility = 'hidden'; tooltipEl.style.opacity = '0';
            }
        });
    };

    async function fetchData() {
        try {
            const res = await fetch("data.json?t=" + Date.now());
            if(!res.ok) throw new Error("Failed to load");
            appData = await res.json();
            
            if(appData.results && appData.results.length > 0) {
                const topModel = appData.results.sort((a,b) => b.braiain_score - a.braiain_score)[0];
                document.title = `Braiain: ${topModel.provider} Leads (${topModel.braiain_score})`;
            }
            
            document.getElementById('node-count').textContent = appData.results ? appData.results.length : 0;
            document.getElementById('last-run').textContent = appData.last_updated ? appData.last_updated.split(' ')[1] + ' UTC' : 'N/A';
            
            populateModelSelector();
            render();
            renderChart();
            renderScatterChart();
            renderSpeedComparison();
            calculateCosts();
        } catch (e) { console.error(e); }
    }

    function startCountdown() {
        setInterval(() => {
            const now = new Date();
            const nowUTC = new Date(now.getTime() + now.getTimezoneOffset() * 60000);
            let nextRun = new Date(nowUTC);
            nextRun.setMinutes(0); nextRun.setSeconds(0);
            const nextHour = Math.ceil((nowUTC.getHours() + 1) / 6) * 6;
            if (nextHour >= 24) { nextRun.setHours(0); nextRun.setDate(nextRun.getDate() + 1); } else { nextRun.setHours(nextHour); }
            const diff = nextRun - nowUTC;
            const h = Math.floor(diff / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            document.getElementById('next-run').textContent = `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        }, 1000);
    }

    function balanceSliders(sourceId) {
        const ids = ['rng-quality', 'rng-speed', 'rng-cost'];
        const els = ids.map(id => document.getElementById(id));
        const sourceIdx = ids.indexOf(sourceId);
        let currentVal = parseInt(els[sourceIdx].value);
        let remaining = 100 - currentVal;
        let other1 = els[(sourceIdx + 1) % 3];
        let other2 = els[(sourceIdx + 2) % 3];
        let val1 = parseInt(other1.value);
        let val2 = parseInt(other2.value);
        let totalOthers = val1 + val2;
        if (totalOthers === 0) { other1.value = remaining / 2; other2.value = remaining / 2; }
        else { other1.value = (val1 / totalOthers) * remaining; other2.value = (val2 / totalOthers) * remaining; }
        updateWeights();
    }

    function updateWeights() {
        const q = parseInt(document.getElementById('rng-quality').value);
        const s = parseInt(document.getElementById('rng-speed').value);
        const c = parseInt(document.getElementById('rng-cost').value);
        document.getElementById('val-quality').textContent = q + '%';
        document.getElementById('val-speed').textContent = s + '%';
        document.getElementById('val-cost').textContent = c + '%';
        appData.results.forEach(r => {
            if(r.status !== 'Online') return;
            const normQuality = r.quality_score; 
            const normSpeed = Math.max(0, 100 - (r.time * 2)); 
            const normCost = Math.max(0, 100 - (r.cost_per_request * 10000));
            const totalWeight = q + s + c || 1;
            r.custom_score = ((normQuality * q) + (normSpeed * s) + (normCost * c)) / totalWeight;
        });
        appData.results.sort((a,b) => (b.custom_score || 0) - (a.custom_score || 0));
        render(); 
        document.querySelectorAll('.ctrl-btn').forEach(b => b.classList.remove('active'));
    }

    function renderRadar(m1, m2) {
        const ctx = document.getElementById('skillRadar');
        if(!ctx) return;
        function getSubScores(model) {
            const b = (model.grade_breakdown || "").toLowerCase();
            return [ b.includes("json") && !b.includes("fail") ? 100 : 40, b.includes("logic correct") ? 100 : 20, b.includes("code perfect") ? 100 : (b.includes("partial") ? 50 : 0) ];
        }
        if(radarChart) radarChart.destroy();
        radarChart = new Chart(ctx, {
            type: 'radar',
            data: { labels: ['JSON', 'LOGIC', 'CODE'], datasets: [ { label: m1.provider, data: getSubScores(m1), fill: true, backgroundColor: 'rgba(0, 255, 65, 0.2)', borderColor: '#00ff41' }, { label: m2.provider, data: getSubScores(m2), fill: true, backgroundColor: 'rgba(255, 0, 85, 0.2)', borderColor: '#ff0055' } ] },
            options: { scales: { r: { angleLines: { color: '#333' }, grid: { color: '#333' }, pointLabels: { color: '#fff', font: { family: 'Orbitron' } }, suggestedMin: 0, suggestedMax: 100 } }, plugins: { legend: { labels: { color: '#fff', font: { family: 'JetBrains Mono' } } } } }
        });
    }

    function renderScatterChart() {
        const ctx = document.getElementById('scatterChart');
        if (!ctx || !appData.results) return;
        const dataPoints = appData.results.filter(r => r.status === 'Online').map(r => ({ x: r.cost_per_request || 0, y: r.braiain_score || 0, provider: r.provider, model: r.model }));
        if (scatterChartInstance) scatterChartInstance.destroy();
        scatterChartInstance = new Chart(ctx, {
            type: 'scatter',
            data: { datasets: [{ label: 'Models', data: dataPoints, backgroundColor: '#00ff41', borderColor: '#fff', borderWidth: 1, pointRadius: 6 }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { x: { title: { display: true, text: 'Cost ($)', color: '#888' }, grid: { color: '#222' }, ticks: { color: '#888' } }, y: { title: { display: true, text: 'Score', color: '#888' }, grid: { color: '#222' }, ticks: { color: '#888' }, min: 0, max: 100 } }, plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => `${c.raw.provider}: Score ${c.raw.y}, $${c.raw.x.toFixed(4)}` } } } }
        });
    }

    function render() {
        if(!appData || !appData.results) return;
        const sorted = [...appData.results].sort((a,b) => {
            if(a.custom_score) return b.custom_score - a.custom_score; 
            if(a.status !== 'Online') return 1; if(b.status !== 'Online') return -1;
            if(currentSort === 'score') return b.braiain_score - a.braiain_score;
            if(currentSort === 'speed') return a.time - b.time;
            if(currentSort === 'tps') return b.tokens_per_second - a.tokens_per_second;
            if(currentSort === 'cost') return a.cost_per_request - b.cost_per_request;
            return 0;
        });

        const gridHtml = sorted.map((r, i) => {
            const comps = parseGrade(r.grade_breakdown);
            return `<div class="bz-card"><div class="bz-card-header"><div><div class="bz-provider">${r.provider}</div><span class="bz-model">${r.model}</span></div><div class="bz-rank">#${i+1}</div></div><div class="bz-stats"><div class="bz-stat-item"><span class="bz-stat-label">SCORE</span><span class="bz-stat-val val-good">${r.custom_score ? Math.round(r.custom_score) : r.braiain_score}</span></div><div class="bz-stat-item"><span class="bz-stat-label">SPEED</span><span class="bz-stat-val">${r.time.toFixed(2)}s</span></div><div class="bz-stat-item"><span class="bz-stat-label">TPS</span><span class="bz-stat-val">${Math.round(r.tokens_per_second)}</span></div><div class="bz-stat-item"><span class="bz-stat-label">COST</span><span class="bz-stat-val">${r.cost_per_request ? '$'+r.cost_per_request.toFixed(4) : 'FREE'}</span></div></div><div class="bz-checks"><div class="bz-check-item"><span class="bz-check-lbl">JSON</span><span class="${comps.json?'icon-ok':'icon-bad'}">${comps.json?'‚úì':'‚úó'}</span></div><div class="bz-check-item"><span class="bz-check-lbl">LOGIC</span><span class="${comps.logic?'icon-ok':'icon-bad'}">${comps.logic?'‚úì':'‚úó'}</span></div><div class="bz-check-item"><span class="bz-check-lbl">CODE</span><span class="${comps.code?'icon-ok':'icon-bad'}">${comps.code?'‚úì':'‚úó'}</span></div></div><div class="bz-preview" onclick="openModal('${r.provider}', '${escapeText(r.full_response)}')"><div class="bz-preview-text">${cleanTextSnippet(r.full_response)}</div></div><div class="bz-actions"><button class="bz-btn btn-outline" onclick="openModal('${r.provider}', '${escapeText(r.full_response)}')">OUTPUT</button><a href="${AFFILIATES[r.provider]||'#'}" target="_blank" class="bz-btn btn-fill">VISIT</a></div></div>`;
        }).join('');
        document.getElementById('grid-container').innerHTML = gridHtml;

        // UPGRADED TABLE RENDERING with JetBrains Mono styling
        const listHtml = sorted.map((r, i) => {
            const comps = parseGrade(r.grade_breakdown);
            const isChecked = selectedForCompare.includes(r.provider) ? 'checked' : '';
            const score = r.custom_score ? Math.round(r.custom_score) : r.braiain_score;
            const scoreClass = score >= 70 ? '' : (score >= 40 ? 'score-mid' : 'score-low');
            const rankClass = i === 0 ? 'gold' : (i === 1 ? 'silver' : (i === 2 ? 'bronze' : ''));
            const costDisplay = r.cost_per_request ? '$'+r.cost_per_request.toFixed(4) : '<span class="table-cost free">FREE</span>';
            return `<tr>
                <td class="col-center"><input type="checkbox" class="model-select" ${isChecked} onchange="toggleCompare('${r.provider}')"></td>
                <td class="col-center"><span class="table-rank ${rankClass}">${i+1}</span></td>
                <td><span class="table-provider">${r.provider}</span></td>
                <td><span class="table-model">${r.model}</span></td>
                <td class="col-center"><span class="table-score ${scoreClass}">${score}</span></td>
                <td class="col-center"><span class="table-metric">${r.time.toFixed(2)}<span class="table-metric-unit">s</span></span></td>
                <td class="col-center"><span class="table-metric">${Math.round(r.tokens_per_second)}</span></td>
                <td class="col-center"><span class="table-metric">${r.ttft ? r.ttft.toFixed(3) : '-'}</span></td>
                <td class="col-center"><span class="table-cost">${costDisplay}</span></td>
                <td class="col-center sparkline-cell"><canvas id="sparkline-${r.provider.replace(/\s+/g,'-')}" class="sparkline-canvas" width="80" height="30"></canvas></td>
                <td class="col-center col-check"><span class="${comps.json?'icon-ok':'icon-bad'}">${comps.json?'‚úì':'‚úó'}</span></td>
                <td class="col-center col-check"><span class="${comps.logic?'icon-ok':'icon-bad'}">${comps.logic?'‚úì':'‚úó'}</span></td>
                <td class="col-center col-check"><span class="${comps.code?'icon-ok':'icon-bad'}">${comps.code?'‚úì':'‚úó'}</span></td>
                <td><div class="table-preview" onclick="openModal('${r.provider}', '${escapeText(r.full_response)}')">${cleanTextSnippet(r.full_response)}</div></td>
                <td class="col-center"><a href="${AFFILIATES[r.provider]||'#'}" target="_blank" class="table-visit-btn">GO</a></td>
            </tr>`;
        }).join('');
        document.getElementById('table-body').innerHTML = listHtml;
        
        setTimeout(() => sorted.forEach(r => {
            const canvas = document.getElementById(`sparkline-${r.provider.replace(/\s+/g,'-')}`);
            if(canvas) drawSparkline(canvas, getSparklineData(r.provider));
        }), 0);
    }

    function toggleCompare(provider) { const idx = selectedForCompare.indexOf(provider); if (idx > -1) selectedForCompare.splice(idx, 1); else { if (selectedForCompare.length >= 2) selectedForCompare.shift(); selectedForCompare.push(provider); } document.getElementById('compare-count').textContent = selectedForCompare.length; document.getElementById('compare-bar').classList.toggle('visible', selectedForCompare.length > 0); render(); }
    function openCompare() { if (selectedForCompare.length < 2) return alert("Select 2 models"); const m1 = appData.results.find(r => r.provider === selectedForCompare[0]); const m2 = appData.results.find(r => r.provider === selectedForCompare[1]); if (!m1 || !m2) return; const html = `<div class="compare-grid"><div class="compare-col"><h3 style="color:#fff; border-bottom:1px solid #333;">${m1.provider}</h3><div class="compare-score">${m1.braiain_score}</div><div style="margin:10px 0; font-size:0.8rem; color:#aaa;">Speed: ${m1.time}s | TPS: ${m1.tokens_per_second}</div><div style="font-family:'JetBrains Mono', monospace; white-space:pre-wrap; font-size:0.8rem; color:#ddd;">${m1.full_response}</div></div><div class="compare-col"><h3 style="color:#fff; border-bottom:1px solid #333;">${m2.provider}</h3><div class="compare-score">${m2.braiain_score}</div><div style="margin:10px 0; font-size:0.8rem; color:#aaa;">Speed: ${m2.time}s | TPS: ${m2.tokens_per_second}</div><div style="font-family:'JetBrains Mono', monospace; white-space:pre-wrap; font-size:0.8rem; color:#ddd;">${m2.full_response}</div></div></div>`; document.getElementById('compare-body').innerHTML = html; document.getElementById('compare-modal').style.display = 'block'; setTimeout(() => renderRadar(m1, m2), 100); }
    function clearCompare() { selectedForCompare = []; document.getElementById('compare-bar').classList.remove('visible'); render(); }
    function closeCompareModal() { document.getElementById('compare-modal').style.display = 'none'; }
    function openModal(t, x) { document.getElementById('modal-title').textContent=t; document.getElementById('modal-text').textContent=x; document.getElementById('modal').style.display='block'; }
    function closeModal() { document.getElementById('modal').style.display='none'; }
    function showStoryModal() { document.getElementById('story-modal').style.display='block'; }
    function closeStoryModal() { document.getElementById('story-modal').style.display='none'; }
    function showPromptModal() { document.getElementById('prompt-modal').style.display='block'; }
    function closePromptModal() { document.getElementById('prompt-modal').style.display='none'; }
    
    function setSort(t) { 
        currentSort=t; 
        // Update sort button active states
        document.querySelectorAll('#sort-score, #sort-speed, #sort-tps, #sort-cost').forEach(b => b.classList.remove('active'));
        document.getElementById('sort-'+t)?.classList.add('active');
        render(); 
    }
    
    function setMode(m) { 
        document.getElementById('grid-container').classList.toggle('hidden',m!=='grid'); 
        document.getElementById('list-container').classList.toggle('hidden',m!=='list'); 
        document.getElementById('btn-grid').classList.toggle('active',m==='grid');
        document.getElementById('btn-list').classList.toggle('active',m==='list');
    }
    
    function escapeText(s) { return (s||"").replace(/'/g,"\\'").replace(/"/g,'&quot;').replace(/\n/g,'\\n'); }
    function cleanTextSnippet(t) { return (t||"").replace(/PART \d+ - [A-Z ]+:/gi,"").replace(/```[a-z]*\n?/gi,"").trim().substring(0,300); }
    function parseGrade(n) { const s=(n||"").toLowerCase(); return { json: s.includes("json")&&!s.includes("fail"), logic: s.includes("logic correct"), code: s.includes("code perfect") }; }
    function populateModelSelector() { const s=document.getElementById('model-overlay-select'); s.innerHTML='<option value="">+ Compare</option>'+appData.results.filter(r=>r.status==='Online').map(r=>`<option value="${r.provider}">${r.provider}</option>`).join(''); }
    function updateChartOverlay() { const v=document.getElementById('model-overlay-select').value; if(v && !selectedOverlayModels.includes(v)) selectedOverlayModels.push(v); renderChart(); }
    
    function setChartMode(m) { 
        currentChartMode=m; 
        document.getElementById('chart-speed').classList.toggle('active',m==='speed');
        document.getElementById('chart-score').classList.toggle('active',m==='score');
        renderChart(); 
    }
    
    function getSparklineData(p) { if(!appData.history) return []; return appData.history.slice(-10).map(h=>h.results?h.results[p]?h.results[p][currentChartMode==='speed'?'time':'braiain_score']:0:0); }
    function drawSparkline(c,d) { if(!d || d.length === 0) return; const ctx=c.getContext('2d'), w=c.width, h=c.height; ctx.clearRect(0,0,w,h); const min=Math.min(...d), max=Math.max(...d); ctx.strokeStyle='#00ff41'; ctx.lineWidth=1.5; ctx.beginPath(); d.forEach((v,i)=>{ const x=i*(w/(d.length-1||1)), y=h-((v-min)/(max-min||1))*h; if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y); }); ctx.stroke(); }
    
    function renderChart() {
        if(!appData.history) return;
        const ctx=document.getElementById('mainChart');
        if(chartInstance) chartInstance.destroy();
        const labels=appData.history.map(h=>new Date(h.timestamp.replace(' UTC','Z')).toLocaleDateString());
        const metric=currentChartMode==='speed'?'time':'braiain_score';
        const datasets=[{ label:'Median', borderColor:'#00ff41', data:appData.history.map(h=> { const v=Object.values(h.results).map(r=>r[metric]).filter(x=>x); return v.sort((a,b)=>a-b)[Math.floor(v.length*0.5)]; }), fill:false }];
        selectedOverlayModels.forEach(p=>datasets.push({ label:p, borderColor:'#00f3ff', borderDash:[5,5], data:appData.history.map(h=>h.results[p]?h.results[p][metric]:null) }));
        chartInstance=new Chart(ctx, { type:'line', data:{labels,datasets}, options:{ responsive:true, maintainAspectRatio:false, plugins:{legend:{labels:{font:{family:'JetBrains Mono'}}}}, scales:{x:{ticks:{color:'#666'}},y:{ticks:{color:'#666'}}} } });
    }
    
    function renderSpeedComparison() {
        const d = appData.results.filter(r=>r.status==='Online').sort((a,b)=>a.time-b.time).slice(0,10);
        const max = Math.max(...d.map(r=>r.time));
        document.getElementById('speed-comparison-container').innerHTML = d.map(r=>`<div style="display:flex; align-items:center; gap:15px; margin-bottom:12px; font-family:'JetBrains Mono', monospace;"><div style="width:120px; color:#fff; font-size:0.85rem;">${r.provider}</div><div style="flex:1; background:#111; height:24px; border-radius:2px; overflow:hidden;"><div style="width:${(r.time/max)*100}%; background: linear-gradient(90deg, #00ff41, #00aa2a); height:100%;"></div></div><div style="width:60px; color:#888; text-align:right; font-size:0.85rem;">${r.time.toFixed(2)}s</div></div>`).join('');
    }
    
    function calculateCosts() {
        const t = parseFloat(document.getElementById('token-input').value)||10;
        const d = appData.results.filter(r=>r.status==='Online').map(r=>({p:r.provider, c:r.cost_per_request*t})).sort((a,b)=>a.c-b.c);
        document.getElementById('cost-results').innerHTML = `<div style="padding:20px; border:1px solid var(--neon-green); border-radius:4px; font-family:'JetBrains Mono', monospace;"><span style="color:#888;">BEST VALUE:</span> <strong style="color:#fff; font-size:1.3rem; margin-left:10px;">${d[0].p}</strong> <span style="color:var(--neon-green); margin-left:15px;">$${d[0].c.toFixed(2)}/mo</span></div>`;
    }
    
    function exportCSV() {
        let csv='Rank,Provider,Model,Score,Speed,TPS,TTFT,Cost\n'+appData.results.map((r,i)=>`${i+1},"${r.provider}","${r.model}",${r.braiain_score},${r.time},${r.tokens_per_second},${r.ttft||''},${r.cost_per_request||0}`).join('\n');
        const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'})); a.download='braiain-data.csv'; a.click();
    }
</script>
</body>
</html>
