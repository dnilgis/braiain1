<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<!-- Cache busting: version stamped on all assets -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<title>BRAIAIN â€” Can You Spot the AI?</title>

<!-- SEO -->
<meta name="description" content="Daily AI detection game. 10 rounds. Are you looking at a real photo or an AI fake? Test your instincts and track your streak.">
<meta name="keywords" content="AI detection, real or fake, AI game, daily challenge, spot the AI, artificial intelligence, image detection">
<meta name="author" content="BRAIAIN">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://braiain.com/">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="BRAIAIN">
<meta property="og:title" content="BRAIAIN â€” Can You Spot the AI?">
<meta property="og:description" content="Daily AI detection challenge. 10 rounds. Real photo or AI fake? Test your instincts.">
<meta property="og:url" content="https://braiain.com">
<meta property="og:image" content="https://braiain.com/og-image.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="BRAIAIN â€” Can You Spot the AI? Daily detection challenge.">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="BRAIAIN â€” Can You Spot the AI?">
<meta name="twitter:description" content="Daily AI detection challenge. Can you tell what's real?">
<meta name="twitter:image" content="https://braiain.com/og-image.png">

<!-- Favicons -->
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="theme-color" content="#00e5ff">
<meta name="msapplication-TileColor" content="#0a0e17">

<!-- Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "BRAIAIN",
  "url": "https://braiain.com",
  "description": "Daily AI detection game. Can you tell real photos from AI-generated images?",
  "applicationCategory": "Game",
  "operatingSystem": "Web",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
}
</script>

<!-- Google Analytics (GA4) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3B3ZCE62NW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-3B3ZCE62NW');
</script>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#06060c;--surface:#0c0c18;--border:#1a1a2e;
  --cyan:#00e5ff;--green:#00ff9d;--red:#ff003c;--amber:#ffb300;
  --text:#e0e0e0;--muted:#5a5a7a;
  --font-display:'Orbitron',sans-serif;
  --font-mono:'Share Tech Mono',monospace;
  --glow-cyan:0 0 20px rgba(0,229,255,.3);
  --glow-green:0 0 20px rgba(0,255,157,.3);
  --glow-red:0 0 20px rgba(255,0,60,.3);
}
html{font-size:16px;-webkit-tap-highlight-color:transparent}
body{
  background:var(--bg);color:var(--text);
  font-family:var(--font-mono);
  min-height:100dvh;overflow-x:hidden;
  display:flex;flex-direction:column;
}
button{font-family:inherit;cursor:pointer;border:none;background:none;color:inherit}
img{display:block;max-width:100%}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CRT SCANLINE OVERLAY
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#crt-overlay{
  position:fixed;inset:0;pointer-events:none;z-index:9999;
  background:repeating-linear-gradient(
    0deg,
    rgba(0,0,0,.03) 0px,
    rgba(0,0,0,.03) 1px,
    transparent 1px,
    transparent 3px
  );
  mix-blend-mode:multiply;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HUD â€” TOP BAR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#hud{
  position:sticky;top:0;z-index:100;
  background:rgba(6,6,12,.92);
  backdrop-filter:blur(12px);
  border-bottom:1px solid var(--border);
  padding:10px 16px;
  display:flex;flex-wrap:wrap;align-items:center;
  gap:6px 16px;
}
#hud-logo{
  font-family:var(--font-display);font-weight:900;
  font-size:1.1rem;letter-spacing:3px;color:var(--cyan);
  text-shadow:var(--glow-cyan);
  flex-shrink:0;
}
#hud-ticker{
  font-size:.7rem;color:var(--muted);
  letter-spacing:1px;text-transform:uppercase;
}
#hud-round{
  margin-left:auto;
  font-family:var(--font-display);font-size:.7rem;
  color:var(--cyan);letter-spacing:2px;
}
#hud-pips{display:flex;gap:4px;margin-left:8px}
.pip{
  width:8px;height:8px;border-radius:50%;
  background:var(--border);transition:background .3s,box-shadow .3s;
}
.pip.correct{background:var(--green);box-shadow:var(--glow-green)}
.pip.wrong{background:var(--red);box-shadow:var(--glow-red)}
@media(max-width:480px){
  #hud-ticker{order:3;width:100%;margin-top:2px}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREENS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.screen{
  display:none;flex-direction:column;align-items:center;
  flex:1;padding:20px 16px 40px;
  animation:fadeUp .4s ease-out;
}
.screen.active{display:flex}
@keyframes fadeUp{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:translateY(0)}
}

/* â”€â”€ BOOT SCREEN â”€â”€ */
#screen-boot{justify-content:center;gap:20px;text-align:center}
#boot-logo{
  font-family:var(--font-display);font-weight:900;
  font-size:clamp(2rem,8vw,3.5rem);
  letter-spacing:6px;color:var(--cyan);
  text-shadow:var(--glow-cyan);
}
#boot-sub{font-size:.75rem;color:var(--muted);letter-spacing:2px;text-transform:uppercase}
#boot-stats{
  display:none;gap:24px;margin:16px 0 8px;
}
#boot-stats.visible{display:flex}
.bstat{display:flex;flex-direction:column;align-items:center;gap:2px}
.bstat-num{
  font-family:var(--font-display);font-size:1.3rem;
  font-weight:900;color:var(--cyan);letter-spacing:1px;
}
.bstat-label{
  font-family:var(--font-mono);font-size:.4rem;
  color:var(--muted);letter-spacing:1.5px;
}
#boot-status{font-size:.7rem;color:var(--green);min-height:1.2em}
.boot-btn{
  margin-top:12px;padding:14px 40px;
  font-family:var(--font-display);font-size:.85rem;font-weight:700;
  letter-spacing:3px;text-transform:uppercase;
  color:var(--bg);background:var(--cyan);
  border:none;position:relative;
  clip-path:polygon(8px 0,100% 0,calc(100% - 8px) 100%,0 100%);
  transition:background .2s,transform .1s;
}
.boot-btn:hover{background:var(--green)}
.boot-btn:active{transform:scale(.97)}

/* â”€â”€ GAME SCREEN â”€â”€ */
#screen-game{gap:16px;max-width:640px;width:100%;margin:0 auto}

/* Image container */
#image-frame{
  position:relative;width:100%;
  aspect-ratio:4/3;overflow:hidden;
  border:1px solid var(--border);
  background:var(--surface);
}
#image-frame img{
  width:100%;height:100%;object-fit:cover;
  transition:opacity .3s;
}
#image-frame.loading img{opacity:0}
#scan-line{
  position:absolute;left:0;width:100%;height:2px;
  background:linear-gradient(90deg,transparent,var(--cyan),transparent);
  box-shadow:0 0 12px var(--cyan);
  top:0;opacity:0;pointer-events:none;
  animation:none;
}
@keyframes scanDown{
  0%{top:0;opacity:1}
  100%{top:100%;opacity:.4}
}
#image-frame.scanning #scan-line{animation:scanDown 1.2s ease-in-out forwards}

/* Magnifier */
#magnifier{
  position:absolute;width:120px;height:120px;
  border-radius:50%;border:2px solid var(--cyan);
  box-shadow:var(--glow-cyan);
  pointer-events:none;display:none;
  background-repeat:no-repeat;
  z-index:10;
}

/* Question prompt */
#prompt{
  text-align:center;font-size:.8rem;
  color:var(--muted);letter-spacing:1px;
  text-transform:uppercase;
}

/* HUMAN / AI Buttons */
#choices{display:flex;gap:12px;width:100%;max-width:400px}
.choice-btn{
  flex:1;padding:16px 8px;
  font-family:var(--font-display);font-size:.9rem;font-weight:700;
  letter-spacing:3px;text-transform:uppercase;
  border:2px solid var(--border);
  background:rgba(12,12,24,.6);
  transition:all .2s;position:relative;overflow:hidden;
}
.choice-btn::before{
  content:'';position:absolute;inset:0;
  opacity:0;transition:opacity .2s;
}
.choice-btn.human{color:var(--green)}
.choice-btn.human::before{background:rgba(0,255,157,.08)}
.choice-btn.human:hover,.choice-btn.human:active{
  border-color:var(--green);box-shadow:var(--glow-green);
}
.choice-btn.human:hover::before{opacity:1}
.choice-btn.ai{color:var(--red)}
.choice-btn.ai::before{background:rgba(255,0,60,.08)}
.choice-btn.ai:hover,.choice-btn.ai:active{
  border-color:var(--red);box-shadow:var(--glow-red);
}
.choice-btn.ai:hover::before{opacity:1}
.choice-btn:disabled{opacity:.3;pointer-events:none}

/* â”€â”€ REVEAL PANEL â”€â”€ */
#reveal-panel{
  width:100%;max-width:640px;
  animation:fadeUp .35s ease-out;
  display:none;flex-direction:column;gap:14px;
}
#reveal-panel.active{display:flex}
#reveal-verdict{
  text-align:center;padding:14px;
  font-family:var(--font-display);font-size:1rem;
  font-weight:700;letter-spacing:3px;
  border:1px solid var(--border);
}
#reveal-verdict.correct{color:var(--green);border-color:var(--green);background:rgba(0,255,157,.05)}
#reveal-verdict.wrong{color:var(--red);border-color:var(--red);background:rgba(255,0,60,.05)}
#reveal-source{font-size:.75rem;color:var(--muted);text-align:center}
#reveal-source-link{font-size:.6rem;text-align:center;margin-top:2px}
#reveal-source-link a{color:var(--cyan);opacity:.5;text-decoration:none;letter-spacing:.5px;font-family:var(--font-mono)}
#reveal-source-link a:hover{opacity:.8;text-decoration:underline}
#reveal-tip{
  font-size:.78rem;line-height:1.5;
  padding:12px 14px;
  border-left:2px solid var(--cyan);
  background:rgba(0,229,255,.04);
  color:var(--text);
}
#reveal-tip strong{color:var(--cyan);font-weight:400}
#global-bar-wrap{
  display:flex;align-items:center;gap:10px;
  font-size:.7rem;color:var(--muted);
}
#global-bar{
  flex:1;height:6px;background:var(--border);overflow:hidden;
}
#global-bar-fill{
  height:100%;background:var(--cyan);width:0%;
  transition:width .6s ease-out;
}
#global-label{min-width:80px;text-align:right}
.next-btn{
  align-self:center;padding:12px 32px;
  font-family:var(--font-display);font-size:.75rem;font-weight:700;
  letter-spacing:3px;text-transform:uppercase;
  color:var(--bg);background:var(--cyan);
  clip-path:polygon(6px 0,100% 0,calc(100% - 6px) 100%,0 100%);
  transition:background .2s;
}
.next-btn:hover{background:var(--green)}

/* â”€â”€ RESULTS SCREEN â”€â”€ */
#screen-results{justify-content:center;gap:20px;text-align:center;max-width:520px;margin:0 auto}

/* Score Ring */
#score-ring-wrap{position:relative;width:160px;height:160px}
#score-ring-wrap svg{transform:rotate(-90deg)}
.ring-bg{fill:none;stroke:var(--border);stroke-width:8}
.ring-fg{
  fill:none;stroke:var(--cyan);stroke-width:8;
  stroke-linecap:round;
  stroke-dasharray:440;stroke-dashoffset:440;
  transition:stroke-dashoffset 1.2s ease-out,stroke .3s;
}
#score-center{
  position:absolute;inset:0;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
}
#score-num{
  font-family:var(--font-display);font-weight:900;
  font-size:2.2rem;color:var(--cyan);
}
#score-label{font-size:.65rem;color:var(--muted);letter-spacing:2px;text-transform:uppercase}
#results-title{
  font-family:var(--font-display);font-size:1.1rem;
  font-weight:700;letter-spacing:2px;color:var(--text);
}
#results-streak{font-size:.75rem;color:var(--muted)}

/* Results pip grid */
#results-grid{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
.r-pip{
  width:28px;height:28px;display:flex;
  align-items:center;justify-content:center;
  font-size:.7rem;font-weight:700;
  border:1px solid var(--border);
}
.r-pip.correct{color:var(--green);border-color:var(--green);background:rgba(0,255,157,.08)}
.r-pip.wrong{color:var(--red);border-color:var(--red);background:rgba(255,0,60,.08)}

/* Share buttons */
#share-row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.share-btn{
  padding:10px 20px;font-size:.72rem;font-weight:700;
  letter-spacing:2px;text-transform:uppercase;
  border:1px solid var(--border);background:var(--surface);
  transition:all .2s;
}
.share-btn:hover{border-color:var(--cyan);color:var(--cyan)}
#countdown-wrap{
  text-align:center;padding:20px 0 8px;
  border-top:1px solid var(--border);margin-top:8px;
}
#countdown-label{
  font-family:var(--font-mono);font-size:.5rem;
  color:var(--muted);letter-spacing:3px;display:block;margin-bottom:6px;
}
#countdown{
  font-family:var(--font-display);font-size:2rem;font-weight:900;
  color:var(--cyan);letter-spacing:4px;
  text-shadow:0 0 20px rgba(0,229,255,.3),0 0 40px rgba(0,229,255,.1);
  display:block;
}

/* Toast */
#toast{
  position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(20px);
  padding:10px 24px;background:var(--surface);
  border:1px solid var(--cyan);color:var(--cyan);
  font-size:.75rem;letter-spacing:1px;
  opacity:0;transition:all .3s;z-index:200;pointer-events:none;
}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VERTICAL COLLAPSE TRANSITION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes collapseOut{
  0%{opacity:1;transform:scaleY(1)}
  100%{opacity:0;transform:scaleY(0)}
}
@keyframes expandIn{
  0%{opacity:0;transform:scaleY(0)}
  100%{opacity:1;transform:scaleY(1)}
}
.collapse-out{animation:collapseOut .25s ease-in forwards;transform-origin:top}
.expand-in{animation:expandIn .3s ease-out forwards;transform-origin:top}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TEXT SCRAMBLE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.scrambling{color:var(--cyan) !important}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIP TERMINAL (FOOTER)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tip-terminal{
  text-align:center;padding:24px 16px 20px;
  border-top:1px solid rgba(0,229,255,.15);margin-top:auto;
  display:none;
}
.tip-terminal.visible{display:block}
.tip-terminal .tip-label{
  font-family:var(--font-display);font-size:.55rem;
  letter-spacing:3px;color:var(--cyan);margin-bottom:10px;opacity:.7;
}
.tip-keys{display:flex;gap:10px;justify-content:center;margin-bottom:8px}
.tip-key{
  padding:8px 20px;font-family:var(--font-mono);font-size:.65rem;
  letter-spacing:1px;font-weight:700;
  border:1px solid rgba(0,229,255,.25);background:rgba(0,229,255,.05);
  color:var(--cyan);opacity:.8;
  transition:all .25s;cursor:pointer;
}
.tip-key:hover{opacity:1;border-color:var(--cyan);box-shadow:var(--glow-cyan)}
.tip-key:active{transform:scale(.95)}
.tip-key.copied{opacity:1;color:var(--green);border-color:var(--green)}
.tip-hint{
  font-family:var(--font-mono);font-size:.48rem;
  color:var(--muted);letter-spacing:1.5px;text-align:center;
  opacity:.6;margin-bottom:8px;
}
.tip-footer-note{
  font-size:.45rem;color:var(--muted);letter-spacing:1px;
  margin-top:10px;opacity:.5;
}
.tip-footer-credit{
  font-size:.38rem;color:var(--bg);letter-spacing:.5px;
  margin-top:6px;opacity:.15;transition:opacity .4s;
}
.tip-footer-credit:hover{opacity:.5}
.tip-footer-credit a{color:inherit;text-decoration:none}
.tip-footer-credit a:hover{color:var(--cyan);opacity:1}
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TODAY'S REVIEW
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#review-section{
  display:none;max-width:640px;margin:0 auto;
  padding:32px 16px 40px;
}
#review-section.visible{display:block}
.yd-header{
  text-align:center;margin-bottom:20px;
  border-top:1px solid var(--border);padding-top:28px;
}
.yd-label{
  font-family:var(--font-display);font-size:.5rem;
  letter-spacing:3px;color:var(--muted);margin-bottom:4px;
}
.yd-title{
  font-family:var(--font-display);font-size:.9rem;
  letter-spacing:2px;color:var(--cyan);font-weight:700;
}
.yd-subtitle{
  font-size:.65rem;color:var(--muted);margin-top:4px;letter-spacing:.5px;
}
.yd-grid{
  display:grid;grid-template-columns:repeat(2,1fr);gap:10px;
}
@media(max-width:480px){.yd-grid{grid-template-columns:1fr}}
.yd-card{
  background:var(--surface);border:1px solid var(--border);
  overflow:hidden;transition:border-color .25s;
}
.yd-card:hover{border-color:rgba(0,229,255,.3)}
.yd-card-img-wrap{position:relative;overflow:hidden}
.yd-card-img{
  width:100%;aspect-ratio:4/3;object-fit:cover;
  display:block;filter:brightness(.85);
}
.yd-stat-badge{
  position:absolute;top:0;right:0;
  padding:5px 8px;
  font-family:var(--font-mono);font-size:.65rem;font-weight:700;
  letter-spacing:.5px;
  background:rgba(5,10,14,.85);
  border-left:1px solid var(--border);border-bottom:1px solid var(--border);
}
.yd-stat-badge.high{color:var(--green);border-color:rgba(0,255,157,.3)}
.yd-stat-badge.mid{color:var(--cyan);border-color:rgba(0,229,255,.3)}
.yd-stat-badge.low{color:var(--red);border-color:rgba(255,0,60,.3)}
.yd-stat-badge.none{color:var(--muted)}
.yd-card-body{padding:8px 10px}
.yd-card-row{
  display:flex;align-items:center;justify-content:space-between;
  gap:6px;
}
.yd-card-label{
  font-family:var(--font-mono);font-size:.6rem;
  letter-spacing:1px;font-weight:700;
}
.yd-card-label.human{color:var(--green)}
.yd-card-label.ai{color:var(--red)}
.yd-card-round{
  font-family:var(--font-mono);font-size:.45rem;
  color:var(--muted);letter-spacing:1px;
}
.yd-card-attrib{
  font-size:.55rem;color:var(--muted);
  margin-top:3px;line-height:1.3;
}
.yd-card-source{
  margin-top:4px;
}
.yd-card-source a{
  font-family:var(--font-mono);font-size:.45rem;
  color:var(--cyan);opacity:.5;text-decoration:none;letter-spacing:.5px;
}
.yd-card-source a:hover{opacity:.9;text-decoration:underline}

</style>
</head>
<body>

<!-- CRT Overlay -->
<div id="crt-overlay"></div>

<!-- HUD -->
<header id="hud" style="display:none">
  <div id="hud-logo">BRAIAIN</div>
  <div id="hud-ticker">LOADING...</div>
  <div id="hud-round">--/--</div>
  <div id="hud-pips"></div>
</header>

<!-- BOOT SCREEN -->
<main id="screen-boot" class="screen active">
  <div id="boot-logo">BRAIAIN</div>
  <div id="boot-sub">CAN YOU SPOT THE AI?</div>
  <div id="boot-stats">
    <div class="bstat"><span class="bstat-num" id="bs-played">0</span><span class="bstat-label">DAYS PLAYED</span></div>
    <div class="bstat"><span class="bstat-num" id="bs-avg">â€”</span><span class="bstat-label">AVG SCORE</span></div>
    <div class="bstat"><span class="bstat-num" id="bs-yesterday">â€”</span><span class="bstat-label">YESTERDAY</span></div>
    <div class="bstat"><span class="bstat-num" id="bs-best">0</span><span class="bstat-label">BEST STREAK</span></div>
  </div>
  <div id="boot-status"></div>
  <button class="boot-btn" id="btn-start" style="display:none" onclick="startGame()">BEGIN SCAN</button>
</main>

<!-- GAME SCREEN -->
<main id="screen-game" class="screen">
  <div id="image-frame">
    <img id="game-img" src="" alt="Analyze this image" draggable="false">
    <div id="scan-line"></div>
    <div id="magnifier"></div>
  </div>
  <div id="prompt">CLASSIFY: HUMAN OR AI-GENERATED?</div>
  <div id="choices">
    <button class="choice-btn human" onclick="choose('human')">HUMAN</button>
    <button class="choice-btn ai" onclick="choose('ai')">AI</button>
  </div>
  <div id="reveal-panel">
    <div id="reveal-verdict"></div>
    <div id="reveal-source"></div>
    <div id="reveal-source-link"></div>
    <div id="reveal-tip"></div>
    <div id="global-bar-wrap">
      <span>GLOBAL ACCURACY</span>
      <div id="global-bar"><div id="global-bar-fill"></div></div>
      <span id="global-label">ESTABLISHING CONNECTION</span>
    </div>
    <button class="next-btn" onclick="nextRound()">NEXT SCAN â†’</button>
  </div>
</main>

<!-- RESULTS SCREEN -->
<main id="screen-results" class="screen">
  <div id="score-ring-wrap">
    <svg viewBox="0 0 160 160" width="160" height="160">
      <circle class="ring-bg" cx="80" cy="80" r="70"/>
      <circle class="ring-fg" id="ring-fg" cx="80" cy="80" r="70"/>
    </svg>
    <div id="score-center">
      <div id="score-num">0</div>
      <div id="score-label">OF 10</div>
    </div>
  </div>
  <div id="results-title"></div>
  <div id="results-streak"></div>
  <div id="results-grid"></div>
  <div id="share-row">
    <button class="share-btn" onclick="shareClipboard()">ğŸ“‹ COPY</button>
    <button class="share-btn" onclick="shareX()">ğ• SHARE</button>
  </div>
  <div id="countdown-wrap">
    <span id="countdown-label">NEXT CHALLENGE DROPS IN</span>
    <span id="countdown">--:--:--</span>
  </div>
</main>

<!-- TODAY'S REVIEW (shown after game) -->
<section id="review-section">
  <div class="yd-header">
    <div class="yd-label">// MISSION DEBRIEF</div>
    <div class="yd-title" id="review-title">TODAY'S ANSWERS</div>
    <div class="yd-subtitle" id="review-subtitle"></div>
  </div>
  <div class="yd-grid" id="review-grid"></div>
</section>

<!-- Toast -->
<div id="toast"></div>

<!-- Tip Terminal -->
<div class="tip-terminal">
  <div class="tip-label">// TIP THE DEVELOPER</div>
  <div class="tip-keys">
    <button class="tip-key" data-chain="eth" onclick="copyTip('eth')">âŸ  ETH</button>
    <button class="tip-key" data-chain="sol" onclick="copyTip('sol')">â— SOL</button>
    <button class="tip-key" data-chain="kas" onclick="copyTip('kas')">â¬¡ KAS</button>
  </div>
  <div class="tip-hint">TAP TO COPY WALLET ADDRESS</div>
  <div class="tip-footer-note">BRAIAIN &copy; 2026 â€” SYSTEM SECURE. NO PERSONAL DATA ARCHIVED.</div>
  <div class="tip-footer-credit">A <a href="mailto:dnilgis@gmail.com">dnilgis</a> Project</div>
</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VERSION & CACHE BUSTING
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const APP_VERSION = '2.1.0';
const BUILD_HASH = Date.now().toString(36).slice(-6);

// Force reload if version mismatch (cache bust across deploys)
(function cacheBust() {
  const stored = localStorage.getItem('braiain_version');
  if (stored && stored !== APP_VERSION) {
    localStorage.setItem('braiain_version', APP_VERSION);
    // Clear old caches
    if ('caches' in window) {
      caches.keys().then(names => names.forEach(n => caches.delete(n)));
    }
    window.location.reload(true);
    return;
  }
  localStorage.setItem('braiain_version', APP_VERSION);
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GA4 EVENT HELPERS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function trackEvent(name, params) {
  if (typeof gtag === 'function') {
    gtag('event', name, params || {});
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONFIG
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const API_BASE = 'https://api.braiain.com';
const TOTAL_ROUNDS = 10;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let dailyData = null;
let currentRound = 0;
let results = [];
let streak = 0;
let bestStreak = 0;
let gameActive = false;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FALLBACK DATA â€” Hardcoded reliable Unsplash IDs
   If daily.json fails to load, use these.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const FALLBACK = {
  day_number: 0,
  date: 'offline',
  category: 'Image Detection',
  category_emoji: 'ğŸ”',
  rounds: [
    {
      id:'f1',type:'image',source:'human',
      content:'https://picsum.photos/id/10/800/600',
      attribution:'Real photograph â€” Yosemite Valley landscape',
      pro_tip:'ATMOSPHERIC DEPTH: Real landscapes show natural haze and color shifts in the distance. AI often renders backgrounds too sharply or with artificial blur.'
    },
    {
      id:'f2',type:'image',source:'ai',
      content:'https://picsum.photos/id/338/800/600',
      attribution:'AI-generated â€” digital artwork',
      pro_tip:'UNCANNY SYMMETRY: AI tends to create suspiciously balanced compositions. Real photos have natural asymmetry â€” objects slightly off-center, uneven lighting.'
    },
    {
      id:'f3',type:'image',source:'human',
      content:'https://picsum.photos/id/15/800/600',
      attribution:'Real photograph â€” dog portrait',
      pro_tip:'FUR DETAIL: Real animal fur has irregular patterns and individual hairs catching light differently. AI fur often looks too uniform or creates impossible light reflections.'
    },
    {
      id:'f4',type:'image',source:'ai',
      content:'https://picsum.photos/id/399/800/600',
      attribution:'AI-generated â€” surreal scene',
      pro_tip:'PHYSICS CHECK: Look for impossible reflections, shadows going the wrong direction, or objects floating without support. AI struggles with physical consistency.'
    },
    {
      id:'f5',type:'image',source:'human',
      content:'https://picsum.photos/id/29/800/600',
      attribution:'Real photograph â€” food styling',
      pro_tip:'ORGANIC CHAOS: Real food photos have natural imperfections â€” a crumb out of place, uneven sauce drips. AI food looks suspiciously perfect.'
    },
    {
      id:'f6',type:'image',source:'ai',
      content:'https://picsum.photos/id/64/800/600',
      attribution:'AI-generated â€” portrait',
      pro_tip:'EDGE ARTIFACTS: Zoom into where hair meets background, or where skin meets clothing. AI often creates subtle smearing, haloing, or impossible blending at these boundaries.'
    },
    {
      id:'f7',type:'image',source:'human',
      content:'https://picsum.photos/id/47/800/600',
      attribution:'Real photograph â€” nature close-up',
      pro_tip:'TEXTURE CONSISTENCY: Real textures hold up at every zoom level. AI textures often dissolve into repetitive patterns or meaningless smudges when examined closely.'
    },
    {
      id:'f8',type:'image',source:'ai',
      content:'https://picsum.photos/id/180/800/600',
      attribution:'AI-generated â€” architectural render',
      pro_tip:'TEXT & SIGNAGE: Any text in the image is a dead giveaway. AI consistently mangles letters, producing nonsensical words or characters that almost-but-don\'t-quite look right.'
    },
    {
      id:'f9',type:'image',source:'human',
      content:'https://picsum.photos/id/100/800/600',
      attribution:'Real photograph â€” mountain vista',
      pro_tip:'NOISE PATTERN: Real photos have consistent sensor noise across the entire image. AI images have unnaturally clean areas mixed with over-detailed zones.'
    },
    {
      id:'f10',type:'image',source:'ai',
      content:'https://picsum.photos/id/274/800/600',
      attribution:'AI-generated â€” fantasy landscape',
      pro_tip:'REPETITIVE ELEMENTS: Count similar objects (leaves, bricks, windows). AI loves to create subtle copy-paste patterns. Nature never repeats this precisely.'
    }
  ]
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TEXT SCRAMBLE EFFECT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const GLYPHS = '!@#$%^&*()_+-=[]{}|;:,.<>?/~`Î”Î£Î©Î»Î¼Ï€';
function scrambleText(el, finalText, duration = 600) {
  return new Promise(resolve => {
    el.classList.add('scrambling');
    const len = finalText.length;
    const steps = 12;
    let step = 0;
    const iv = setInterval(() => {
      step++;
      const progress = step / steps;
      let display = '';
      for (let i = 0; i < len; i++) {
        if (i / len < progress) {
          display += finalText[i];
        } else {
          display += GLYPHS[Math.floor(Math.random() * GLYPHS.length)];
        }
      }
      el.textContent = display;
      if (step >= steps) {
        clearInterval(iv);
        el.textContent = finalText;
        el.classList.remove('scrambling');
        resolve();
      }
    }, duration / steps);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT SEQUENCE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function boot() {
  const status = document.getElementById('boot-status');
  const logo = document.getElementById('boot-logo');
  const sub = document.getElementById('boot-sub');

  // Scramble logo
  await scrambleText(logo, 'BRAIAIN', 800);
  await scrambleText(sub, 'CAN YOU SPOT THE AI?', 500);

  // Show running stats on home screen
  loadBootStats();

  // Check for already-played today
  loadStreak();
  const todayKey = getTodayKey();
  const played = localStorage.getItem('braiain_played_' + todayKey);

  // Load daily data
  status.textContent = '> LOADING DAILY CHALLENGE...';
  try {
    const resp = await fetchWithTimeout('daily.json?v=' + APP_VERSION + '&t=' + BUILD_HASH, {}, 5000);
    if (!resp.ok) throw new Error('HTTP ' + resp.status);
    dailyData = await resp.json();
    status.textContent = '> DAY ' + dailyData.day_number + ' â€” ' + (dailyData.category || 'DETECTION').toUpperCase() + ' LOADED';
  } catch (e) {
    dailyData = FALLBACK;
    status.textContent = '> OFFLINE MODE â€” USING CACHED DATA';
  }

  await sleep(400);

  // Start preloading all images in background
  preloadAllImages();

  if (played) {
    // Already played â€” show results
    try {
      const saved = JSON.parse(localStorage.getItem('braiain_results_' + todayKey));
      if (saved && saved.length) {
        results = saved;
        currentRound = TOTAL_ROUNDS;
        showResults();
        return;
      }
    } catch (e) {}
  }

  document.getElementById('btn-start').style.display = '';
  status.textContent = '> READY â€” ' + dailyData.rounds.length + ' TARGETS QUEUED';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GAME FLOW
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function startGame() {
  haptic('tap');
  trackEvent('game_start', { day: dailyData.day_number });
  gameActive = true;
  currentRound = 0;
  results = [];
  showScreen('screen-game');
  document.getElementById('hud').style.display = '';
  updateHUD();
  loadRound();
}

function loadRound() {
  if (currentRound >= TOTAL_ROUNDS || currentRound >= dailyData.rounds.length) {
    endGame();
    return;
  }

  const round = dailyData.rounds[currentRound];
  const frame = document.getElementById('image-frame');
  const img = document.getElementById('game-img');
  const revealPanel = document.getElementById('reveal-panel');
  const choices = document.getElementById('choices');

  // Reset UI
  revealPanel.classList.remove('active');
  revealPanel.style.display = 'none';
  choices.style.display = '';
  document.querySelectorAll('.choice-btn').forEach(b => b.disabled = false);
  frame.classList.remove('scanning');
  frame.classList.add('loading');

  // Load image
  img.onload = () => {
    frame.classList.remove('loading');
    frame.classList.add('scanning');
    // Enable magnifier after scan
    setTimeout(() => {
      frame.classList.remove('scanning');
      initMagnifier(img);
    }, 1200);
  };
  img.onerror = () => {
    frame.classList.remove('loading');
    // Fallback: try without query params
    if (img.src.includes('?')) {
      img.src = img.src.split('?')[0];
    }
  };
  img.src = round.content;

  // Preload next round's image for zero lag
  preloadNextImage(currentRound + 1);

  // Update prompt
  scrambleText(document.getElementById('prompt'), 'CLASSIFY: HUMAN OR AI-GENERATED?', 300);
  updateHUD();
}

function choose(answer) {
  if (!gameActive) return;

  haptic('tap');

  const round = dailyData.rounds[currentRound];
  const isCorrect = answer === round.source;
  results.push(isCorrect);

  // Haptic result feedback (slight delay so tap registers first)
  setTimeout(() => haptic(isCorrect ? 'correct' : 'wrong'), 150);

  // Disable buttons
  document.querySelectorAll('.choice-btn').forEach(b => b.disabled = true);

  // Highlight chosen button
  const btns = document.querySelectorAll('.choice-btn');
  btns.forEach(b => {
    if ((answer === 'human' && b.classList.contains('human')) ||
        (answer === 'ai' && b.classList.contains('ai'))) {
      b.style.borderColor = isCorrect ? 'var(--green)' : 'var(--red)';
      b.style.boxShadow = isCorrect ? 'var(--glow-green)' : 'var(--glow-red)';
    }
  });

  // Update pip
  const pips = document.querySelectorAll('.pip');
  if (pips[currentRound]) {
    pips[currentRound].classList.add(isCorrect ? 'correct' : 'wrong');
  }

  // Show reveal
  showReveal(round, isCorrect);

  // Report to API (fire and forget)
  reportVote(round.id, isCorrect);
}

function showReveal(round, isCorrect) {
  const panel = document.getElementById('reveal-panel');
  const verdict = document.getElementById('reveal-verdict');
  const source = document.getElementById('reveal-source');
  const tip = document.getElementById('reveal-tip');
  const choices = document.getElementById('choices');

  verdict.className = 'reveal-verdict ' + (isCorrect ? 'correct' : 'wrong');
  verdict.textContent = isCorrect ? 'âœ“ CORRECT â€” ' + round.source.toUpperCase() : 'âœ— WRONG â€” IT WAS ' + round.source.toUpperCase();

  source.textContent = round.attribution || '';

  // Show source image URL
  const sourceLink = document.getElementById('reveal-source-link');
  if (round.content && round.source === 'human') {
    sourceLink.innerHTML = '<a href="' + round.content + '" target="_blank" rel="noopener">[ VIEW SOURCE IMAGE â†— ]</a>';
  } else {
    sourceLink.innerHTML = '';
  }

  tip.innerHTML = '<strong>PRO TIP:</strong> ' + (round.pro_tip || '');

  // Fetch global accuracy
  fetchGlobalAccuracy(round.id);

  // Collapse choices, expand reveal
  choices.style.display = 'none';
  panel.style.display = '';
  panel.classList.add('active');

  // Update next button text on last round
  const nextBtn = panel.querySelector('.next-btn');
  if (currentRound >= TOTAL_ROUNDS - 1 || currentRound >= dailyData.rounds.length - 1) {
    nextBtn.textContent = 'VIEW RESULTS â†’';
  } else {
    nextBtn.textContent = 'NEXT SCAN â†’';
  }
}

function nextRound() {
  haptic('tap');
  currentRound++;
  if (currentRound >= TOTAL_ROUNDS || currentRound >= dailyData.rounds.length) {
    endGame();
  } else {
    loadRound();
  }
}

function endGame() {
  gameActive = false;
  haptic('finish');
  const todayKey = getTodayKey();
  localStorage.setItem('braiain_played_' + todayKey, '1');
  localStorage.setItem('braiain_results_' + todayKey, JSON.stringify(results));

  const score = results.filter(Boolean).length;
  trackEvent('game_complete', { score: score, total: TOTAL_ROUNDS, day: dailyData.day_number });
  updateStreak(score);
  showResults();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESULTS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showResults() {
  showScreen('screen-results');
  document.getElementById('hud').style.display = 'none';
  document.querySelector('.tip-terminal').classList.add('visible');

  const score = results.filter(Boolean).length;
  const titles = [
    'COMPLETELY COMPROMISED','SYSTEM FAILURE','WEAK SIGNAL','PARTIAL DETECTION',
    'HALF MEASURES','MEDIOCRE SCAN','DECENT INSTINCTS','SHARP DETECTOR',
    'ELITE SCANNER','NEAR PERFECT','VOIGHT-KAMPFF MASTER'
  ];

  // Score ring animation
  const ring = document.getElementById('ring-fg');
  const circumference = 2 * Math.PI * 70; // r=70
  const offset = circumference - (score / TOTAL_ROUNDS) * circumference;
  setTimeout(() => {
    ring.style.strokeDashoffset = offset;
    if (score >= 7) ring.style.stroke = 'var(--green)';
    else if (score >= 4) ring.style.stroke = 'var(--cyan)';
    else ring.style.stroke = 'var(--red)';
  }, 100);

  document.getElementById('score-num').textContent = score;
  scrambleText(document.getElementById('results-title'), titles[score], 500);
  document.getElementById('results-streak').textContent =
    streak > 0 ? 'ğŸ”¥ ' + streak + '-day streak | Best: ' + bestStreak : 'Best streak: ' + bestStreak;

  // Pip grid
  const grid = document.getElementById('results-grid');
  grid.innerHTML = '';
  results.forEach(c => {
    const pip = document.createElement('div');
    pip.className = 'r-pip ' + (c ? 'correct' : 'wrong');
    pip.textContent = c ? 'âœ“' : 'âœ—';
    grid.appendChild(pip);
  });

  startCountdown();
  loadTodayReview();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAGNIFIER (Touch + Mouse)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function initMagnifier(img) {
  const frame = document.getElementById('image-frame');
  const mag = document.getElementById('magnifier');
  const zoom = 2.5;

  function show(x, y) {
    const rect = frame.getBoundingClientRect();
    const px = (x - rect.left) / rect.width;
    const py = (y - rect.top) / rect.height;
    if (px < 0 || px > 1 || py < 0 || py > 1) { mag.style.display = 'none'; return; }

    mag.style.display = 'block';
    mag.style.left = (x - rect.left - 60) + 'px';
    mag.style.top = (y - rect.top - 60) + 'px';
    mag.style.backgroundImage = 'url(' + img.src + ')';
    mag.style.backgroundSize = (rect.width * zoom) + 'px ' + (rect.height * zoom) + 'px';
    mag.style.backgroundPosition =
      (-px * rect.width * zoom + 60) + 'px ' +
      (-py * rect.height * zoom + 60) + 'px';
  }

  function hide() { mag.style.display = 'none'; }

  // Mouse
  frame.onmousemove = e => show(e.clientX, e.clientY);
  frame.onmouseleave = hide;

  // Touch
  frame.ontouchmove = e => {
    e.preventDefault();
    const t = e.touches[0];
    show(t.clientX, t.clientY);
  };
  frame.ontouchend = hide;
  frame.ontouchcancel = hide;

  // Tap to toggle on mobile
  let magVisible = false;
  frame.ontouchstart = e => {
    if (e.touches.length === 1) {
      magVisible = !magVisible;
      if (magVisible) {
        const t = e.touches[0];
        show(t.clientX, t.clientY);
      } else {
        hide();
      }
    }
  };
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HUD UPDATES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function updateHUD() {
  const cat = dailyData ? (dailyData.category_emoji || '') + ' ' + (dailyData.category || '').toUpperCase() : '';
  const dayNum = dailyData ? dailyData.day_number : '--';
  document.getElementById('hud-ticker').textContent = 'DAY ' + dayNum + ' â€” ' + cat;
  document.getElementById('hud-round').textContent = (currentRound + 1) + '/' + TOTAL_ROUNDS;

  // Build pips
  const pipWrap = document.getElementById('hud-pips');
  pipWrap.innerHTML = '';
  for (let i = 0; i < TOTAL_ROUNDS; i++) {
    const p = document.createElement('div');
    p.className = 'pip';
    if (i < results.length) p.classList.add(results[i] ? 'correct' : 'wrong');
    pipWrap.appendChild(p);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STREAK
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadStreak() {
  streak = parseInt(localStorage.getItem('braiain_streak') || '0');
  bestStreak = parseInt(localStorage.getItem('braiain_best_streak') || '0');
  const last = localStorage.getItem('braiain_last_date');
  const today = getTodayKey();
  const yesterday = getYesterdayKey();
  if (last !== today && last !== yesterday) streak = 0;
}

function updateStreak(score) {
  const today = getTodayKey();
  const last = localStorage.getItem('braiain_last_date');
  const yesterday = getYesterdayKey();

  if (score >= 5) {
    if (last === yesterday || !last) streak++;
    else if (last !== today) streak = 1;
  } else {
    streak = 0;
  }
  if (streak > bestStreak) bestStreak = streak;

  localStorage.setItem('braiain_streak', streak);
  localStorage.setItem('braiain_best_streak', bestStreak);
  localStorage.setItem('braiain_last_date', today);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   API
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function reportVote(questionId, wasCorrect) {
  try {
    await fetchWithTimeout(API_BASE + '/vote', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ id: questionId, correct: wasCorrect })
    }, 4000);
  } catch (e) { /* silent */ }
}

async function fetchGlobalAccuracy(questionId) {
  const fill = document.getElementById('global-bar-fill');
  const label = document.getElementById('global-label');
  try {
    const resp = await fetchWithTimeout(API_BASE + '/stats?id=' + questionId, {}, 4000);
    if (!resp.ok) throw new Error();
    const data = await resp.json();
    if (data.total > 0) {
      const pct = Math.round(data.pct);
      fill.style.width = pct + '%';
      label.textContent = pct + '% of ' + data.total + ' players';
      return;
    }
  } catch (e) { /* fall through */ }
  fill.style.width = '0%';
  label.textContent = 'ESTABLISHING CONNECTION';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHARE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function getShareText() {
  const score = results.filter(Boolean).length;
  const day = dailyData ? dailyData.day_number : '?';
  const grid = results.map(c => c ? 'ğŸŸ©' : 'ğŸŸ¥').join('');
  const lines = [
    'BRAIAIN Day ' + day + ' â€” ' + score + '/' + TOTAL_ROUNDS,
    grid,
    streak > 0 ? 'ğŸ”¥ ' + streak + ' day streak' : '',
    '',
    'Can you spot the AI? â†’ braiain.com'
  ];
  return lines.filter(l => l !== '').join('\n');
}

function shareClipboard() {
  haptic('tap');
  trackEvent('share', { method: 'clipboard' });
  const text = getShareText();
  if (navigator.share) {
    navigator.share({ text }).catch(() => copyFallback(text));
  } else {
    copyFallback(text);
  }
}

function copyFallback(text) {
  navigator.clipboard.writeText(text).then(() => {
    showToast('COPIED TO CLIPBOARD');
  }).catch(() => showToast('COPY FAILED'));
}

function shareX() {
  haptic('tap');
  trackEvent('share', { method: 'twitter' });
  const text = encodeURIComponent(getShareText());
  window.open('https://twitter.com/intent/tweet?text=' + text, '_blank');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COUNTDOWN TO NEXT DAY
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function startCountdown() {
  function tick() {
    const now = new Date();
    const tom = new Date(now);
    tom.setUTCDate(tom.getUTCDate() + 1);
    tom.setUTCHours(0, 0, 0, 0);
    const diff = tom - now;
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    const el = document.getElementById('countdown');
    if (el) el.textContent = String(h).padStart(2, '0') + ':' + String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
  }
  tick();
  setInterval(tick, 1000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TODAY'S REVIEW (post-game debrief)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadTodayReview() {
  const section = document.getElementById('review-section');
  if (!dailyData || !dailyData.rounds) return;

  // Header
  const catEmoji = dailyData.category_emoji || 'ğŸ‘ï¸';
  document.getElementById('review-title').textContent =
    catEmoji + ' ' + (dailyData.category || 'IMAGE DETECTION').toUpperCase();
  document.getElementById('review-subtitle').textContent =
    'Day ' + (dailyData.day_number || '1') + ' â€” All 10 Answers Revealed';

  // Build cards
  const grid = document.getElementById('review-grid');
  grid.innerHTML = '';

  const rounds = dailyData.rounds.slice(0, TOTAL_ROUNDS);
  for (let i = 0; i < rounds.length; i++) {
    const r = rounds[i];
    const card = document.createElement('div');
    card.className = 'yd-card';

    const isHuman = r.source === 'human';
    const labelClass = isHuman ? 'human' : 'ai';
    const labelText = isHuman ? 'âœ“ HUMAN' : 'âœ— AI-GENERATED';

    // Show user's answer as a pip
    const userCorrect = results[i];
    const pipClass = userCorrect ? 'correct' : 'wrong';
    const pipText = userCorrect ? 'âœ“' : 'âœ—';

    // Source link (only for real photos)
    const sourceLink = isHuman
      ? '<div class="yd-card-source"><a href="' + r.content + '" target="_blank" rel="noopener">[ VIEW SOURCE â†— ]</a></div>'
      : '';

    card.innerHTML =
      '<div class="yd-card-img-wrap">' +
        '<img class="yd-card-img" src="' + r.content + '" alt="Round ' + (i + 1) + '" loading="lazy" onerror="this.style.display=\'none\'">' +
        '<div class="yd-stat-badge none" id="rv-badge-' + i + '">â€”</div>' +
      '</div>' +
      '<div class="yd-card-body">' +
        '<div class="yd-card-row">' +
          '<span class="yd-card-label ' + labelClass + '">' + labelText + '</span>' +
          '<span class="yd-card-round"><span class="r-pip ' + pipClass + '" style="width:20px;height:20px;font-size:.55rem;display:inline-flex">' + pipText + '</span> R' + (i + 1) + '</span>' +
        '</div>' +
        '<div class="yd-card-attrib">' + (r.attribution || '') + '</div>' +
        sourceLink +
      '</div>';

    grid.appendChild(card);

    // Fetch community stats per round
    fetchReviewStat(r.id, i);
  }

  setTimeout(() => { section.classList.add('visible'); }, 300);
}

async function fetchReviewStat(roundId, index) {
  const badge = document.getElementById('rv-badge-' + index);
  try {
    const resp = await fetchWithTimeout(API_BASE + '/stats?id=' + roundId, {}, 4000);
    if (!resp.ok) throw new Error('no stats');
    const data = await resp.json();
    const pct = Math.round(data.pct || 0);
    if (badge) {
      badge.textContent = pct + '%';
      badge.className = 'yd-stat-badge ' + (pct >= 70 ? 'high' : pct >= 40 ? 'mid' : 'low');
    }
  } catch (e) {
    if (badge) {
      badge.textContent = 'â€”';
      badge.className = 'yd-stat-badge none';
    }
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT SCREEN STATS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadBootStats() {
  let daysPlayed = 0;
  let totalScore = 0;

  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key && key.startsWith('braiain_results_')) {
      try {
        const r = JSON.parse(localStorage.getItem(key));
        if (Array.isArray(r) && r.length > 0) {
          daysPlayed++;
          totalScore += r.filter(Boolean).length;
        }
      } catch (e) {}
    }
  }

  const bestStrk = parseInt(localStorage.getItem('braiain_best_streak') || '0');

  // Yesterday's score
  const ydKey = getYesterdayKey();
  const ydEl = document.getElementById('bs-yesterday');
  try {
    const ydResults = JSON.parse(localStorage.getItem('braiain_results_' + ydKey));
    if (Array.isArray(ydResults) && ydResults.length > 0) {
      const ydScore = ydResults.filter(Boolean).length;
      ydEl.textContent = ydScore + '/10';
      if (ydScore >= 8) ydEl.style.color = 'var(--green)';
      else if (ydScore <= 3) ydEl.style.color = 'var(--red)';
    }
  } catch (e) {}

  if (daysPlayed > 0) {
    const avg = Math.round((totalScore / daysPlayed) * 10) / 10;
    document.getElementById('bs-played').textContent = daysPlayed;
    document.getElementById('bs-avg').textContent = avg + '/10';
    document.getElementById('bs-best').textContent = bestStrk;
    document.getElementById('boot-stats').classList.add('visible');
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   IMAGE PRELOADING
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const preloadCache = new Map();

function preloadNextImage(nextIndex) {
  if (!dailyData || !dailyData.rounds) return;
  if (nextIndex >= dailyData.rounds.length || nextIndex >= TOTAL_ROUNDS) return;
  const url = dailyData.rounds[nextIndex].content;
  if (preloadCache.has(url)) return;
  const img = new Image();
  img.src = url;
  preloadCache.set(url, img);
}

function preloadAllImages() {
  if (!dailyData || !dailyData.rounds) return;
  // Preload first 3 immediately, rest after short delay
  const rounds = dailyData.rounds.slice(0, TOTAL_ROUNDS);
  rounds.slice(0, 3).forEach(r => {
    if (!preloadCache.has(r.content)) {
      const img = new Image();
      img.src = r.content;
      preloadCache.set(r.content, img);
    }
  });
  // Preload remaining after 2s
  setTimeout(() => {
    rounds.slice(3).forEach(r => {
      if (!preloadCache.has(r.content)) {
        const img = new Image();
        img.src = r.content;
        preloadCache.set(r.content, img);
      }
    });
  }, 2000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HAPTIC FEEDBACK
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function haptic(pattern) {
  if (!navigator.vibrate) return;
  switch (pattern) {
    case 'tap':     navigator.vibrate(8);  break;
    case 'correct': navigator.vibrate([10, 30, 10]); break;
    case 'wrong':   navigator.vibrate([40, 20, 40]); break;
    case 'finish':  navigator.vibrate([10, 20, 10, 20, 30]); break;
    default:        navigator.vibrate(10);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILITIES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function getTodayKey() { return new Date().toISOString().split('T')[0]; }
function getYesterdayKey() { return new Date(Date.now() - 86400000).toISOString().split('T')[0]; }
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

function fetchWithTimeout(url, opts, ms) {
  const ctrl = new AbortController();
  const t = setTimeout(() => ctrl.abort(), ms);
  return fetch(url, { ...opts, signal: ctrl.signal }).finally(() => clearTimeout(t));
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIP TERMINAL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const TIP_ADDRS = {
  eth: '0x3e3eaf955a6ea978e7694574b14cd8bf082e79cf',
  sol: 'GStGz2ztQ2UqMGPXA8j2i9PSFhpaYsjxwbLTttUKD74d',
  kas: 'kaspa:qps9fumvkw0n29hkjrk7lumpuu64k2u9ug543lg9ga'
};

function copyTip(chain) {
  haptic('tap');
  const addr = TIP_ADDRS[chain];
  const btn = document.querySelector('.tip-key[data-chain="' + chain + '"]');
  navigator.clipboard.writeText(addr).then(() => {
    btn.classList.add('copied');
    btn.textContent = 'âœ“ COPIED';
    showToast(chain.toUpperCase() + ' ADDRESS COPIED');
    trackEvent('tip_copy', { chain: chain });
    setTimeout(() => {
      btn.classList.remove('copied');
      const labels = { eth: 'âŸ  ETH', sol: 'â— SOL', kas: 'â¬¡ KAS' };
      btn.textContent = labels[chain];
    }, 2000);
  }).catch(() => showToast('COPY FAILED'));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEYBOARD SHORTCUTS (Desktop)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('keydown', e => {
  // Game screen: Left/H = Human, Right/A = AI
  if (gameActive && document.getElementById('screen-game').classList.contains('active')) {
    const revealActive = document.getElementById('reveal-panel').classList.contains('active');
    if (!revealActive) {
      if (e.key === 'ArrowLeft' || e.key === 'h' || e.key === 'H') { e.preventDefault(); choose('human'); }
      if (e.key === 'ArrowRight' || e.key === 'a' || e.key === 'A') { e.preventDefault(); choose('ai'); }
    } else {
      // Reveal visible: Enter/Space/Right = Next
      if (e.key === 'Enter' || e.key === ' ' || e.key === 'ArrowRight') { e.preventDefault(); nextRound(); }
    }
  }
  // Review modal: Escape to close
  if (e.key === 'Escape') {
    const modal = document.getElementById('review-modal');
    if (modal && modal.classList.contains('active')) { e.preventDefault(); modal.classList.remove('active'); }
  }
  // Boot screen: Enter to start
  if (e.key === 'Enter' && document.getElementById('screen-boot').classList.contains('active')) {
    const btn = document.getElementById('btn-start');
    if (btn && btn.style.display !== 'none') { e.preventDefault(); startGame(); }
  }
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
boot();
</script>
</body>
</html>
